{"version":3,"names":["ZegoSignalingPluginCore","ZegoPluginResult","zlogerror","zloginfo","ZegoUIKitCorePlugin","Platform","ZegoPluginInvitationService","constructor","_defineProperty","shared","_notifyWhenAppRunningInBackgroundOrQuit","getInstance","setBackgroundMessageHandler","getZPNsPlugin","default","message","dataObj","JSON","parse","extras","payload","zim_call_id","call_id","getAndroidOfflineDataHandler","setAndroidOfflineDataHandler","handler","_androidOfflineDataHandler","setIOSOfflineDataHandler","_iOSOfflineDataHandler","onCallKitAnswerCall","_callKitAnswerCallHandler","onCallKitEndCall","_callKitEndCallHandler","getIOSOfflineDataHandler","getAnswerCallHandle","getEndCallHandle","reportCallKitCallEnded","uuid","reason","CallKit","reportCallEnded","getZIMInstance","getVersion","init","appID","appSign","create","uninit","destroy","login","userID","userName","token","logout","enableNotifyWhenAppRunningInBackgroundOrQuit","enable","isIOSDevelopmentEnvironment","appName","OS","CXProviderConfiguration","localizedName","iconTemplateImageName","setInitConfiguration","applyNotificationPermission","iOSEnvironment","console","log","registerPush","enableIOSVoIP","setPushConfig","on","action","fulfill","off","sendInvitation","inviterName","invitees","timeout","type","data","notificationConfig","length","Promise","reject","config","extendedData","stringify","inviter_name","pushConfig","title","content","resourcesID","resourceID","invite","cancelInvitation","map","invitee","callID","getCallIDByUserID","getLocalUser","cancel","refuseInvitation","inviterID","acceptInvitation","accept","queryCallList","count","nextFlag","onConnectionStateChanged","callbackID","callback","onCallInvitationReceived","onCallInvitationTimeout","onCallInviteesAnsweredTimeout","onCallInvitationAccepted","onCallInvitationRejected","onCallInvitationCancelled","_class"],"sources":["index.ts"],"sourcesContent":["import ZegoSignalingPluginCore from '../core';\nimport ZegoPluginResult from '../core/defines';\nimport { zlogerror, zloginfo } from '../utils/logger';\nimport type { CXAction, ZPNsRegisterMessage, ZPNsMessage } from 'zego-zpns-react-native';\nimport type { ZIMCallInviteConfig, ZIMCallCancelConfig, ZIMConnectionState } from 'zego-zim-react-native';\nimport { CXCallEndedReason } from '../defines';\nimport ZegoUIKitCorePlugin from '../../components/internal/ZegoUIKitCorePlugin';\nimport { Platform } from 'react-native';\n\nexport default class ZegoPluginInvitationService {\n  static shared: ZegoPluginInvitationService;\n  _notifyWhenAppRunningInBackgroundOrQuit: boolean;\n  _androidOfflineDataHandler: (data: any) => void;\n  _iOSOfflineDataHandler: (data: any, uuid: string) => void;\n  _callKitAnswerCallHandler: (action: CXAction) => void;\n  _callKitEndCallHandler: (action: CXAction) => void;\n\n  constructor() {\n    if (!ZegoPluginInvitationService.shared) {\n      this._notifyWhenAppRunningInBackgroundOrQuit = true;\n      ZegoPluginInvitationService.shared = this;\n    }\n    return ZegoPluginInvitationService.shared;\n  }\n  static getInstance() {\n    if (!ZegoPluginInvitationService.shared) {\n      ZegoPluginInvitationService.shared = new ZegoPluginInvitationService();\n    }\n    return ZegoPluginInvitationService.shared;\n  }\n  setBackgroundMessageHandler() {\n    ZegoUIKitCorePlugin.getZPNsPlugin().default.setBackgroundMessageHandler((message: ZPNsMessage) => {\n      zloginfo('ZPNs setBackgroundMessageHandler: ', message)\n      const dataObj = JSON.parse(message.extras.payload);\n      dataObj.zim_call_id = message.extras.call_id;\n      ZegoPluginInvitationService.getInstance().getAndroidOfflineDataHandler()(dataObj)\n    })\n  }\n  setAndroidOfflineDataHandler(handler: (data: any) => void) {\n    this._androidOfflineDataHandler = handler;\n  }\n  getAndroidOfflineDataHandler() {\n    return this._androidOfflineDataHandler;\n  }\n  setIOSOfflineDataHandler(handler: (data: any, uuid: string) => void) {\n    this._iOSOfflineDataHandler = handler;\n  }\n  onCallKitAnswerCall(handler: (action: CXAction) => void) {\n    this._callKitAnswerCallHandler = handler;\n  }\n  onCallKitEndCall(handler: (action: CXAction) => void) {\n    this._callKitEndCallHandler = handler;\n  }\n  getIOSOfflineDataHandler() {\n    return this._iOSOfflineDataHandler;\n  }\n  getAnswerCallHandle() {\n    return this._callKitAnswerCallHandler;\n  }\n  getEndCallHandle() {\n    return this._callKitEndCallHandler;\n  }\n  reportCallKitCallEnded(uuid: string, reason: number) {\n    return ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().reportCallEnded(reason, uuid);\n  }\n  getZIMInstance() {\n    return ZegoSignalingPluginCore.getInstance().getZIMInstance();\n  }\n  getVersion() {\n    return ZegoSignalingPluginCore.getInstance().getVersion();\n  }\n  init(appID: number, appSign: string) {\n    ZegoSignalingPluginCore.getInstance().create({\n      appID,\n      appSign,\n    });\n  }\n  uninit() {\n    ZegoSignalingPluginCore.getInstance().destroy();\n  }\n  login(userID: string, userName: string, token?: string) {\n    return ZegoSignalingPluginCore.getInstance().login(\n      {\n        userID,\n        userName,\n      },\n      token\n    );\n  }\n  logout() {\n    return ZegoSignalingPluginCore.getInstance().logout();\n  }\n\n  enableNotifyWhenAppRunningInBackgroundOrQuit(enable: boolean, isIOSDevelopmentEnvironment?: boolean, appName?: string) {\n    this._notifyWhenAppRunningInBackgroundOrQuit = enable;\n\n    if (enable) {\n      if (Platform.OS === 'ios') {\n        const CXProviderConfiguration = {\n          localizedName: appName ?? 'My app',\n          iconTemplateImageName: \"AppIcon\",\n        };\n        ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.setInitConfiguration(CXProviderConfiguration);\n        ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().applyNotificationPermission();\n        \n        const iOSEnvironment = isIOSDevelopmentEnvironment == null ? 2 : (isIOSDevelopmentEnvironment ? 1 : 0);\n        console.log('#########registerPush, iOSEnvironment', iOSEnvironment);\n        ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().registerPush({ \n          enableIOSVoIP: true,\n          iOSEnvironment: iOSEnvironment,\n        });\n      } else {\n        ZegoUIKitCorePlugin.getZPNsPlugin().default.setPushConfig({ \"enableFCMPush\": true, \"enableHWPush\": false, \"enableMiPush\": false, \"enableOppoPush\": false, \"enableVivoPush\": false });\n\n        ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().registerPush({ enableIOSVoIP: true });\n      }\n\n\n      ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().on(\"registered\", (message: ZPNsRegisterMessage) => {\n        console.log(\"@@@@@@@@@@@@@@@@>>>>>>>>>>>>>>>############\", message)\n      });\n\n      // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().on(\"notificationArrived\", (message) => {\n      //   console.log(\"@@@@@@@@@@@@@@@@notificationArrived>>>>>>>>>>>>>>>############\", getCallID(message))\n      //   setZpnState(\"notificationArrived: \" + getCallID(message))\n      // })\n      // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().on(\"notificationClicked\", (message) => {\n      //   console.log(\"@@@@@@@@@@@@@@@@notificationClicked>>>>>>>>>>>>>>>############\", getCallID(message))\n      //   setZpnState(\"notificationClicked: \" + getCallID(message))\n      // })\n      // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().on(\"throughMessageReceived\", (message) => {\n      //   console.log(\"@@@@@@@@@@@@@@@@throughMessageReceived>>>>>>>>>>>>>>>############\", getCallID(message))\n      //   setZpnState(\"throughMessageReceived: \" + getCallID(message))\n      // })\n\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"didReceiveIncomingPush\", (extras: Record<string, any>, uuid: string) => {\n        console.log('#########didReceiveIncomingPush', extras, uuid);\n        let { payload } = extras;\n        let { call_id } = extras;\n        const dataObj = payload ? JSON.parse(payload) : {};\n        dataObj.zim_call_id = call_id;\n        ZegoPluginInvitationService.getInstance().getIOSOfflineDataHandler()(dataObj, uuid);\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"providerDidReset\", () => {\n        console.log('#########providerDidReset');\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"providerDidBegin\", () => {\n        console.log('#########providerDidBegin');\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"didActivateAudioSession\", () => {\n        console.log('#########didActivateAudioSession');\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"didDeactivateAudioSession\", () => {\n        console.log('#########didDeactivateAudioSession');\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"timedOutPerformingAction\", (action: CXAction) => {\n        console.log('#########timedOutPerformingAction', action);\n        action.fulfill();\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performStartCallAction\", (action: CXAction) => {\n        console.log('#########performStartCallAction', action);\n        action.fulfill();\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performAnswerCallAction\", (action: CXAction) => {\n        console.log('#########performAnswerCallAction', action);\n        ZegoPluginInvitationService.getInstance().getAnswerCallHandle()(action);\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performEndCallAction\", (action: CXAction) => {\n        console.log('#########performEndCallAction', action);\n        ZegoPluginInvitationService.getInstance().getEndCallHandle()(action);\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performSetHeldCallAction\", (action: CXAction) => {\n        console.log('#########performSetHeldCallAction', action);\n        action.fulfill();\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performSetMutedCallAction\", (action: CXAction) => {\n        console.log('#########performSetMutedCallAction', action);\n        action.fulfill();\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performSetGroupCallAction\", (action: CXAction) => {\n        console.log('#########performSetGroupCallAction', action);\n        action.fulfill();\n      });\n      ZegoUIKitCorePlugin.getZPNsPlugin().CallKit.getInstance().on(\"performPlayDTMFCallAction\", (action: CXAction) => {\n        console.log('#########performPlayDTMFCallAction', action);\n        action.fulfill();\n      });\n    } else {\n      if (ZegoUIKitCorePlugin.getZPNsPlugin()) {\n        // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().unregisterPush();\n        ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().off(\"registered\")\n        // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().off(\"notificationArrived\")\n        // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().off(\"notificationClicked\")\n        // ZegoUIKitCorePlugin.getZPNsPlugin().default.getInstance().off(\"throughMessageReceived\")\n      }\n    }\n\n  }\n  sendInvitation(inviterName: string, invitees: string[], timeout: number, type: number, data?: string, notificationConfig?: any) {\n\n    // invitees = invitees.map((invitee) => invitee);\n    if (!invitees.length) {\n      zlogerror('[Service]Send invitees is empty.');\n      return Promise.reject(new ZegoPluginResult());\n    }\n    const config = { timeout } as ZIMCallInviteConfig;\n    config.extendedData = JSON.stringify({\n      inviter_name: inviterName,\n      type,\n      data,\n    });\n\n    if (this._notifyWhenAppRunningInBackgroundOrQuit) {\n      config.pushConfig = {\n        title: notificationConfig.title ?? \"\",\n        content: notificationConfig.message ?? \"\",\n        resourcesID: notificationConfig.resourceID ?? \"\",\n        payload: data\n      };\n    }\n    zloginfo(\n      `[Service]Send invitation: invitees: ${invitees}, timeout: ${timeout}, type: ${type}, data: ${data}.`\n    );\n    return ZegoSignalingPluginCore.getInstance().invite(invitees, config);\n  }\n  cancelInvitation(invitees: string[], data?: string, notificationConfig?: any) {\n    invitees = invitees.map((invitee) => invitee);\n    if (!invitees.length) {\n      zlogerror('[Service]Cancel invitees is empty.');\n      return Promise.reject(new ZegoPluginResult());\n    }\n    const config = { extendedData: data } as ZIMCallCancelConfig;\n    if (this._notifyWhenAppRunningInBackgroundOrQuit) {\n      config.pushConfig = {\n        title: notificationConfig && notificationConfig.title,\n        content: notificationConfig && notificationConfig.message,\n        resourcesID: notificationConfig && notificationConfig.resourceID,\n        payload: data\n      };\n    }\n    const callID = ZegoSignalingPluginCore.getInstance().getCallIDByUserID(\n      ZegoSignalingPluginCore.getInstance().getLocalUser().userID\n    );\n    zloginfo(\n      `[Service]Cancel invitation: callID: ${callID}, invitees: ${invitees}, data: ${data}.`\n    );\n    return ZegoSignalingPluginCore.getInstance().cancel(\n      invitees,\n      callID,\n      config\n    );\n  }\n  refuseInvitation(inviterID: string, data?: string) {\n    let callID;\n    // Parse data and adapt automatic rejection\n    if (data) {\n      const dataObj = JSON.parse(data);\n      callID = dataObj.callID;\n    } else {\n      callID =\n        ZegoSignalingPluginCore.getInstance().getCallIDByUserID(inviterID);\n    }\n    if (!callID) {\n      zlogerror('[Service]Call id corresponding to the inviterID is empty.');\n      return Promise.reject(new ZegoPluginResult());\n    }\n    const config = { extendedData: data };\n    zloginfo(\n      `[Service]Refuse invitation: callID: ${callID}, inviter id: ${inviterID}, data: ${data}.`\n    );\n    return ZegoSignalingPluginCore.getInstance().reject(callID, config);\n  }\n  acceptInvitation(inviterID: string, data?: string) {\n    const callID =\n      ZegoSignalingPluginCore.getInstance().getCallIDByUserID(inviterID);\n    if (!callID) {\n      zloginfo('[Service]Call id corresponding to the inviterID is empty.', inviterID, data);\n      return Promise.reject(new ZegoPluginResult());\n    }\n    const config = { extendedData: data };\n    zloginfo(\n      `[Service]Accept invitation: callID: ${callID}, inviter id: ${inviterID}, data: ${data}.`\n    );\n    return ZegoSignalingPluginCore.getInstance().accept(callID, config);\n  }\n\n  queryCallList(count: number, nextFlag?: number) {\n    const config = { count: count, nextFlag: nextFlag}\n    return ZegoSignalingPluginCore.getInstance().queryCallList(config);\n  }\n\n  onConnectionStateChanged(callbackID: string, callback: (notifyData: { state: ZIMConnectionState }) => void) {\n    ZegoSignalingPluginCore.getInstance().onConnectionStateChanged(\n      callbackID,\n      callback\n    );\n  }\n  onCallInvitationReceived(callbackID: string, callback: (notifyData: {\n    callID: string;\n    inviter: { name: string; id: string; };\n    type: number;\n    data: string;\n  }) => void) {\n    ZegoSignalingPluginCore.getInstance().onCallInvitationReceived(\n      callbackID,\n      callback\n    );\n  }\n  onCallInvitationTimeout(callbackID: string, callback: (notifyData: {\n    callID: string;\n    inviter: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    ZegoSignalingPluginCore.getInstance().onCallInvitationTimeout(\n      callbackID,\n      callback\n    );\n  }\n  onCallInviteesAnsweredTimeout(callbackID: string, callback: (notifyData: {\n    callID: string;\n    invitees: { id: string; name: string; }[];\n    data: string;\n  }) => void) {\n    ZegoSignalingPluginCore.getInstance().onCallInviteesAnsweredTimeout(\n      callbackID,\n      callback\n    );\n  }\n  onCallInvitationAccepted(callbackID: string, callback: (notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    ZegoSignalingPluginCore.getInstance().onCallInvitationAccepted(\n      callbackID,\n      callback\n    );\n  }\n  onCallInvitationRejected(callbackID: string, callback: (notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    ZegoSignalingPluginCore.getInstance().onCallInvitationRejected(\n      callbackID,\n      callback\n    );\n  }\n  onCallInvitationCancelled(callbackID: string, callback: (notifyData: {\n    callID: string;\n    inviter: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    ZegoSignalingPluginCore.getInstance().onCallInvitationCancelled(\n      callbackID,\n      callback\n    );\n  }\n}\n"],"mappings":"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"}
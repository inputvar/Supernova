{"version":3,"names":["React","useEffect","useState","StyleSheet","View","ZegoUIKitInternal","ZegoAudioVideoView","ZegoAudioVideoViewMore","GalleryLayout","props","config","foregroundBuilder","audioVideoConfig","addBorderRadiusAndSpacingBetweenView","ownViewBackgroundColor","othersViewBackgroundColor","ownViewBackgroundImage","othersViewBackgroundImage","useVideoViewAspectFill","showSoundWavesInAudioMode","localUserID","setLocalUserID","userList","setUserList","moreUserList","setMoreUserList","callbackID","String","Math","floor","random","onSDKConnected","getLocalUserInfo","userID","onRoomStateChanged","reason","onUserCountOrPropertyChanged","index","findIndex","user","splice","concat","slice","getAudioVideoViewStyle","len","length","audioVideoViewSizeStyle","styles","audioVideoViewSize1","audioVideoViewSize2","audioVideoViewSize4","audioVideoViewSize6","audioVideoViewSize8","audioVideoViewSizeMore","isAudioVideoViewPadding","audioVideoViewPadding","isAudioVideoViewBorder","audioVideoViewBorder","createElement","style","container","map","key","audioVideoViewContainer","audioVideoViewSubContainer","audioViewBackgroudColor","audioViewBackgroudImage","showSoundWave","create","flex","width","height","backgroundColor","flexDirection","flexWrap","zIndex","overflow","background","borderRadius","paddingLeft","paddingRight","paddingTop","paddingBottom"],"sources":["GalleryLayout.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { StyleSheet, View, Text } from 'react-native'\nimport ZegoUIKitInternal from \"../../internal/ZegoUIKitInternal\";\nimport ZegoAudioVideoView from \"../../audio_video/ZegoAudioVideoView\";\nimport ZegoAudioVideoViewMore from \"./MoreFrame\";\nimport { ZegoRoomStateChangedReason } from \"zego-express-engine-reactnative\";\n\nexport default function GalleryLayout(props: any) {\n    const { config = {}, foregroundBuilder, audioVideoConfig = {} } = props;\n    const {\n        addBorderRadiusAndSpacingBetweenView = true, // Whether to display rounded corners and spacing between Views\n        ownViewBackgroundColor = '',\n        othersViewBackgroundColor = '',\n        ownViewBackgroundImage = '',\n        othersViewBackgroundImage = '',\n    } = config;\n    const {\n        useVideoViewAspectFill = false,\n        showSoundWavesInAudioMode = true,\n    } = audioVideoConfig;\n\n    const [localUserID, setLocalUserID] = useState('');\n    const [userList, setUserList] = useState([]);\n    const [moreUserList, setMoreUserList] = useState([]);\n\n    useEffect(() => {\n        const callbackID = 'GalleryLayout' + String(Math.floor(Math.random() * 10000));\n        ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n            setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n        });\n        ZegoUIKitInternal.onRoomStateChanged(callbackID, (reason: ZegoRoomStateChangedReason) => {\n            if (reason == 1 || reason == 4) {\n                setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n            } else if (reason == 2 || reason == 5 || reason == 6 || reason == 7) {\n                // ZegoRoomStateChangedReasonLoginFailed\n                // ZegoRoomStateChangedReasonReconnectFailed\n                // ZegoRoomStateChangedReasonKickOut\n                // ZegoRoomStateChangedReasonLogout\n                // ZegoRoomStateChangedReasonLogoutFailed\n                setLocalUserID('');\n            }\n        })\n        ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList: any[]) => {\n            // console.warn('>>>>>>>>>>> onUserCountOrPropertyChanged', userList)\n            // Put yourself first\n            const index = userList.findIndex((user => user.userID == ZegoUIKitInternal.getLocalUserInfo().userID));\n            index !== -1 && (userList = userList.splice(index, 1).concat(userList));\n            setUserList(userList.slice(0, 7));\n            setMoreUserList(userList.slice(7));\n        });\n        return () => {\n            ZegoUIKitInternal.onSDKConnected(callbackID);\n            ZegoUIKitInternal.onRoomStateChanged(callbackID);\n            ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n        }\n    }, []);\n\n    const getAudioVideoViewStyle = () => {\n        const len = userList.length;\n        let audioVideoViewSizeStyle;\n        switch (len) {\n            case 1:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize1;\n                break;\n            case 2:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize2;\n                break;\n            case 3:\n            case 4:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize4;\n                break;\n            case 5:\n            case 6:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize6;\n                break;\n            case 7:\n            case 8:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize8;\n                break;\n            default:\n                audioVideoViewSizeStyle = styles.audioVideoViewSizeMore;\n                break;\n        }\n        return audioVideoViewSizeStyle;\n    }\n\n    const isAudioVideoViewPadding = addBorderRadiusAndSpacingBetweenView && userList.length > 1 ? styles.audioVideoViewPadding : null;\n    const isAudioVideoViewBorder = addBorderRadiusAndSpacingBetweenView && userList.length > 1 ? styles.audioVideoViewBorder : null;\n\n    return (<View style={[styles.container, isAudioVideoViewPadding]}>\n        {\n            userList.map((user, index) => <View key={user.userID} style={[\n                styles.audioVideoViewContainer,\n                getAudioVideoViewStyle(),\n                isAudioVideoViewPadding\n            ]}>\n                <View style={[styles.audioVideoViewSubContainer, isAudioVideoViewBorder]}>\n                    <ZegoAudioVideoView\n                        userID={user.userID}\n                        audioViewBackgroudColor={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundColor : othersViewBackgroundColor}\n                        audioViewBackgroudImage={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundImage : othersViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    />\n                </View>\n            </View>)\n        }\n        {\n            moreUserList.length <=1 ? moreUserList.map((user, index) => <View key={user.userID} style={[\n                styles.audioVideoViewContainer,\n                getAudioVideoViewStyle(),\n                isAudioVideoViewPadding\n            ]}>\n                <View style={[styles.audioVideoViewSubContainer, isAudioVideoViewBorder]}>\n                    <ZegoAudioVideoView\n                        userID={user.userID}\n                        audioViewBackgroudColor={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundColor : othersViewBackgroundColor}\n                        audioViewBackgroudImage={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundImage : othersViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    />\n                </View>\n            </View>) : <View style={[styles.audioVideoViewContainer, getAudioVideoViewStyle(), isAudioVideoViewPadding]}>\n                <View style={[styles.audioVideoViewSubContainer, isAudioVideoViewBorder]}>\n                    <ZegoAudioVideoViewMore \n                        userList={moreUserList}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        audioViewBackgroudColor={othersViewBackgroundColor}\n                        audioViewBackgroudImage={othersViewBackgroundImage}\n                    />\n                </View>\n            </View>\n        }\n    </View>)\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        width: '100%',\n        height: '100%',\n        backgroundColor: '#171821',\n        flexDirection: 'row',\n        flexWrap: 'wrap'\n    },\n    audioVideoViewContainer: {\n        zIndex: 1,\n    },\n    audioVideoViewSubContainer: {\n        width: '100%',\n        height: '100%',\n        overflow: 'hidden',\n        background: '#D8D8D8',\n    },\n    audioVideoViewBorder: {\n        borderRadius: 10,\n    },\n    audioVideoViewPadding: {\n        paddingLeft: 2.5,\n        paddingRight: 2.5,\n        paddingTop: 2.5,\n        paddingBottom: 2.5,\n    },\n\n    audioVideoViewSize1: {\n        width: '100%',\n        height: '100%',\n    },\n    audioVideoViewSize2: {\n        width: '100%',\n        height: '50%',\n    },\n    audioVideoViewSize4: {\n        width: '50%',\n        height: '50%',\n    },\n    audioVideoViewSize6: {\n        width: '50%',\n        height: '33.33%',\n    },\n    audioVideoViewSize8: {\n        width: '50%',\n        height: '25%',\n    },\n    audioVideoViewSizeMore: {\n        width: '50%',\n        height: '25%',\n    },\n});"],"mappings":"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"}
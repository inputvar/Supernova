{"version":3,"names":["React","useEffect","useState","useRef","FlatList","Text","StyleSheet","View","ZegoUIKitInternal","Delegate","ZegoInRoomMessageView","props","itemBuilder","listRef","messageList","setMessageList","refreshMessage","arr","getInRoomMessages","renderItem","_ref","item","createElement","style","styles","messageContainer","nameLabel","sender","userName","messageLabel","message","to","callbackID","String","Math","floor","random","onInRoomMessageReceived","onInRoomMessageSent","showsVerticalScrollIndicator","ref","data","onContentSizeChange","length","current","scrollToEnd","create","alignSelf","backgroundColor","borderRadius","flexDirection","justifyContent","alignItems","marginTop","paddingTop","paddingBottom","paddingRight","paddingLeft","color","fontSize","marginLeft"],"sources":["ZegoInRoomMessageView.tsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { FlatList, Text, StyleSheet, View } from 'react-native';\nimport ZegoUIKitInternal from '../internal/ZegoUIKitInternal';\nimport Delegate from 'react-delegate-component';\n\nexport default function ZegoInRoomMessageView(props: any) {\n  const { itemBuilder } = props;\n  const listRef = useRef(null);\n  const [messageList, setMessageList] = useState([]);\n\n  const refreshMessage = () => {\n    // Update list like this will cause rerender\n    setMessageList((arr) => [...ZegoUIKitInternal.getInRoomMessages()]);\n  };\n  const renderItem = ({ item }: any) => {\n    return (\n      !itemBuilder ? <View style={styles.messageContainer}>\n        <Text style={styles.nameLabel}>\n          {item.sender.userName}\n          <Text style={styles.messageLabel}> {item.message}</Text>\n        </Text>\n      </View> : <Delegate to={itemBuilder} props={{ message: item }} />\n    );\n  }\n\n  useEffect(() => {\n    refreshMessage();\n  }, []);\n  useEffect(() => {\n    const callbackID =\n      'ZegoInRoomMessageView' + String(Math.floor(Math.random() * 10000));\n    ZegoUIKitInternal.onInRoomMessageReceived(callbackID, () => {\n      refreshMessage();\n    });\n    ZegoUIKitInternal.onInRoomMessageSent(callbackID, () => {\n      refreshMessage();\n    });\n\n    return () => {\n      ZegoUIKitInternal.onInRoomMessageReceived(callbackID);\n      ZegoUIKitInternal.onInRoomMessageSent(callbackID);\n    };\n  }, []);\n  return (\n    <FlatList\n      showsVerticalScrollIndicator={false}\n      ref={listRef}\n      data={messageList}\n      // https://stackoverflow.com/questions/46304677/scrolltoend-after-update-data-for-flatlist\n      onContentSizeChange={() => {\n        if (messageList.length) {\n          listRef.current.scrollToEnd();\n        }\n      }}\n      renderItem={renderItem}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  messageContainer: {\n    alignSelf: 'flex-start',\n    backgroundColor: 'rgba(1, 7, 18, 0.3000)',\n    borderRadius: 13,\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'center',\n    marginTop: 4,\n    paddingTop: 5,\n    paddingBottom: 5,\n    paddingRight: 10,\n    paddingLeft: 10,\n  },\n  nameLabel: {\n    color: '#8BE7FF',\n    fontSize: 13,\n    // marginLeft: 10\n  },\n  messageLabel: {\n    color: 'white',\n    fontSize: 13,\n    marginLeft: 5,\n  },\n});\n"],"mappings":"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"}
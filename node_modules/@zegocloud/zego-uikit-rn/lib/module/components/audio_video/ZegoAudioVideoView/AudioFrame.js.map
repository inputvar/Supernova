{"version":3,"names":["View","StyleSheet","Text","ImageBackground","Image","React","useState","useEffect","ZegoUIKitInternal","Delegate","defaultAvatarSizeRatio","flexStyle","AudioFrame","props","userInfo","showSoundWave","audioViewBackgroudColor","audioViewBackgroudImage","avatarBackgroundColor","avatarSize","avatarAlignment","avatarBuilder","soundWaveColor","avatar","soundLevel","setSoundLevel","dimensions","setDimensions","width","height","isLoadError","setIsLoadError","getShotName","name","nl","split","shotName","forEach","part","substring","callbackID","userID","String","Math","floor","random","onSoundLevelUpdate","createElement","style","cstyle","container","onLayout","event","nativeEvent","layout","source","uri","resizeMode","styles","imgBackground","justifyContent","waveStyle","circleWave","subCircleWave","backgroundColor","nameLabel","userName","onLoadStart","console","log","onLoadEnd","onError","onLoad","alignItems","to","bgColor","create","flex","position","w","color","opacity","alignSelf","aspectRatio","borderRadius","zIndex","alignContent","marginTop","marginBottom","toString","overflow","fontSize"],"sources":["AudioFrame.tsx"],"sourcesContent":["import { View, StyleSheet, Text, ImageBackground, Image } from 'react-native';\nimport React, { useState, useEffect } from 'react';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\nimport Delegate from 'react-delegate-component';\n\nconst defaultAvatarSizeRatio = 129 / 375;\nconst flexStyle = ['center', 'flex-start', 'flex-end'];\n\nexport default function AudioFrame(props: any) {\n  const {\n    userInfo,\n    showSoundWave,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    avatarBackgroundColor = '#DBDDE3',\n    avatarSize,\n    avatarAlignment,\n    avatarBuilder,\n    soundWaveColor = '#6B6A71',\n    avatar = '',\n  } = props;\n\n  const [soundLevel, setSoundLevel] = useState(0);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  const [isLoadError, setIsLoadError] = useState(false);\n\n  const getShotName = (name: string) => {\n    if (!name) {\n      return '';\n    }\n    const nl = name.split(' ');\n    var shotName = '';\n    nl.forEach((part) => {\n      if (part !== '') {\n        shotName += part.substring(0, 1);\n      }\n    });\n    return shotName;\n  };\n\n  useEffect(() => {\n    const callbackID = 'AudioFrame' + userInfo.userID + String(Math.floor(Math.random() * 10000));\n    ZegoUIKitInternal.onSoundLevelUpdate(\n      callbackID,\n      (userID: string, soundLevel: number) => {\n        if (userInfo.userID == userID) {\n          setSoundLevel(soundLevel);\n        }\n      }\n    );\n\n    return () => {\n      ZegoUIKitInternal.onSoundLevelUpdate(callbackID);\n    };\n  }, []);\n\n  return (\n    <View\n      style={\n        cstyle(audioViewBackgroudColor ? audioViewBackgroudColor : '#4A4B4D')\n          .container\n      }\n      onLayout={(event) => {\n        setDimensions({\n          width: event.nativeEvent.layout.width,\n          height: event.nativeEvent.layout.height,\n        });\n      }}\n    >\n      <ImageBackground\n        source={\n          audioViewBackgroudImage ? { uri: audioViewBackgroudImage } : null\n        }\n        resizeMode=\"cover\"\n        style={[\n          styles.imgBackground,\n          // @ts-ignore\n          { justifyContent: flexStyle[avatarAlignment] },\n        ]}\n      >\n        {showSoundWave && soundLevel > 5 ? (\n          <View\n            style={\n              waveStyle(\n                (avatarSize\n                  ? avatarSize.width\n                  : defaultAvatarSizeRatio * dimensions.width) +\n                  0.04 * dimensions.width,\n                soundWaveColor,\n                1\n              ).circleWave\n            }\n          >\n            {soundLevel > 10 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      0.06 * dimensions.width,\n                    soundWaveColor,\n                    0.6\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n            {soundLevel > 15 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      +0.08 * dimensions.width,\n                    soundWaveColor,\n                    0.3\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n          </View>\n        ) : (\n          <View />\n        )}\n        <View\n          style={[\n            styles.avatar,\n            {\n              backgroundColor: avatarBackgroundColor,\n              width: avatarSize\n                ? avatarSize.width\n                : defaultAvatarSizeRatio * dimensions.width,\n            },\n          ]}\n        >\n          {\n            !avatarBuilder ?\n              (!avatar || isLoadError) ?\n                <Text style={styles.nameLabel}>{getShotName(userInfo.userName)}</Text> :\n                <Image \n                  style={{ width: '100%', height: '100%', resizeMode: 'contain' }}\n                  resizeMode=\"contain\"\n                  source={{ uri: avatar }}\n                  onLoadStart={() =>  console.log('avatar onLoadStart')}\n                  onLoadEnd={() =>  console.log('avatar onLoadEnd')}\n                  onError={() =>  { console.log('avatar onError'); setIsLoadError(true);}}\n                  onLoad={() =>  { console.log('avatar onLoad'); setIsLoadError(false);}}\n                />\n              : <View style={{ width: '100%', height: '100%', alignItems: 'center', justifyContent: 'center', }}>\n                {\n                  (!avatar || isLoadError) ? <Text style={styles.nameLabel}>{getShotName(userInfo.userName)}</Text> : null\n                }\n                <Delegate\n                  to={avatarBuilder}\n                  props={{ userInfo: userInfo }}\n                />\n              </View>\n          }\n        </View>\n      </ImageBackground>\n    </View>\n  );\n}\n\nconst cstyle = (bgColor: string) =>\n  StyleSheet.create({\n    container: {\n      flex: 1,\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      justifyContent: 'center',\n      backgroundColor: bgColor,\n    },\n  });\nconst waveStyle = (w: number, color: string, opacity: number) =>\n  StyleSheet.create({\n    circleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 375) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n      justifyContent: 'center',\n      alignContent: 'center',\n    },\n    subCircleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 164) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n    },\n  });\nconst styles = StyleSheet.create({\n  imgBackground: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  avatar: {\n    flex: 1,\n    marginTop: 1.5,\n    marginBottom: 1.5,\n    width: ((129 / 375) * 100).toString() + '%',\n    aspectRatio: 1,\n    borderRadius: 1000,\n    position: 'absolute',\n    alignSelf: 'center',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 2,\n    overflow: 'hidden',\n  },\n  nameLabel: {\n    flex: 1,\n    position: 'absolute',\n    color: '#222222',\n    fontSize: 22,\n  },\n});\n"],"mappings":"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"}
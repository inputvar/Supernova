{"version":3,"names":["zloginfo","zlogerror","ZegoUIKitPluginType","_plugins","Map","ZegoUIKitCorePlugin","installPlugins","plugins","Array","forEach","plugin","ZIMConnectionState","get","set","ZPNsPushSourceType","getInstance","type","getPluginType","Object","values","includes","getZIMPlugin","getZPNsPlugin","getPlugin","signaling"],"sources":["ZegoUIKitCorePlugin.ts"],"sourcesContent":["import { zloginfo, zlogerror } from '../../utils/logger';\nimport { ZegoUIKitPluginType } from './defines';\n\nconst _plugins = new Map(); // type -> plugin\nconst ZegoUIKitCorePlugin = {\n  installPlugins: (plugins: any[]) => {\n    if (!plugins || !(plugins instanceof Array)) {\n      zlogerror('[ZegoUIKitCorePlugin][installPlugins]The parameter passed in was incorrect');\n      return;\n    }\n    plugins.forEach((plugin) => {\n      if (plugin.ZIMConnectionState) {\n        if (_plugins.get('ZIM')) {\n          zloginfo(\n            '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugin: ZIM'\n          );\n        } else {\n          _plugins.set('ZIM', plugin);\n          zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ZIM');\n        }\n      } else if (plugin.ZPNsPushSourceType) {\n        if (_plugins.get('ZPNs')) {\n          zloginfo(\n            '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugin: ZPNs'\n          );\n        } else {\n          _plugins.set('ZPNs', plugin);\n          zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ZPNs');\n        }\n      } else if (typeof plugin.getInstance === 'function') {\n        // Compatible with the original usage\n        const type = plugin.getInstance().getPluginType\n          ? plugin.getInstance().getPluginType()\n          : null;\n        if (Object.values(ZegoUIKitPluginType).includes(type)) {\n          if (_plugins.get(type)) {\n            zloginfo(\n              '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugins: ', type\n            );\n          } else {\n            _plugins.set(type, plugin);\n            zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ', type);\n          }\n        }\n      }\n    });\n  },\n  getZIMPlugin: () => {\n    return _plugins.get('ZIM');\n  },\n  getZPNsPlugin: () => {\n    return _plugins.get('ZPNs');\n  },\n  getPlugin: (type: number) => {\n    if (type === ZegoUIKitPluginType.signaling) {\n      zloginfo('[ZegoUIKitCorePlugin][getPlugin] type: ', type);\n      return _plugins.get(type) || ZegoUIKitCorePlugin.getZIMPlugin();\n    }\n    return _plugins.get(type);\n  },\n};\nexport default ZegoUIKitCorePlugin;\nexport { ZegoUIKitPluginType };\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,oBAAoB;AACxD,SAASC,mBAAmB,QAAQ,WAAW;AAE/C,MAAMC,QAAQ,GAAG,IAAIC,GAAG,CAAC,CAAC,CAAC,CAAC;AAC5B,MAAMC,mBAAmB,GAAG;EAC1BC,cAAc,EAAGC,OAAc,IAAK;IAClC,IAAI,CAACA,OAAO,IAAI,EAAEA,OAAO,YAAYC,KAAK,CAAC,EAAE;MAC3CP,SAAS,CAAC,4EAA4E,CAAC;MACvF;IACF;IACAM,OAAO,CAACE,OAAO,CAAEC,MAAM,IAAK;MAC1B,IAAIA,MAAM,CAACC,kBAAkB,EAAE;QAC7B,IAAIR,QAAQ,CAACS,GAAG,CAAC,KAAK,CAAC,EAAE;UACvBZ,QAAQ,CACN,4GACF,CAAC;QACH,CAAC,MAAM;UACLG,QAAQ,CAACU,GAAG,CAAC,KAAK,EAAEH,MAAM,CAAC;UAC3BV,QAAQ,CAAC,0EAA0E,CAAC;QACtF;MACF,CAAC,MAAM,IAAIU,MAAM,CAACI,kBAAkB,EAAE;QACpC,IAAIX,QAAQ,CAACS,GAAG,CAAC,MAAM,CAAC,EAAE;UACxBZ,QAAQ,CACN,6GACF,CAAC;QACH,CAAC,MAAM;UACLG,QAAQ,CAACU,GAAG,CAAC,MAAM,EAAEH,MAAM,CAAC;UAC5BV,QAAQ,CAAC,2EAA2E,CAAC;QACvF;MACF,CAAC,MAAM,IAAI,OAAOU,MAAM,CAACK,WAAW,KAAK,UAAU,EAAE;QACnD;QACA,MAAMC,IAAI,GAAGN,MAAM,CAACK,WAAW,CAAC,CAAC,CAACE,aAAa,GAC3CP,MAAM,CAACK,WAAW,CAAC,CAAC,CAACE,aAAa,CAAC,CAAC,GACpC,IAAI;QACR,IAAIC,MAAM,CAACC,MAAM,CAACjB,mBAAmB,CAAC,CAACkB,QAAQ,CAACJ,IAAI,CAAC,EAAE;UACrD,IAAIb,QAAQ,CAACS,GAAG,CAACI,IAAI,CAAC,EAAE;YACtBhB,QAAQ,CACN,0GAA0G,EAAEgB,IAC9G,CAAC;UACH,CAAC,MAAM;YACLb,QAAQ,CAACU,GAAG,CAACG,IAAI,EAAEN,MAAM,CAAC;YAC1BV,QAAQ,CAAC,uEAAuE,EAAEgB,IAAI,CAAC;UACzF;QACF;MACF;IACF,CAAC,CAAC;EACJ,CAAC;EACDK,YAAY,EAAEA,CAAA,KAAM;IAClB,OAAOlB,QAAQ,CAACS,GAAG,CAAC,KAAK,CAAC;EAC5B,CAAC;EACDU,aAAa,EAAEA,CAAA,KAAM;IACnB,OAAOnB,QAAQ,CAACS,GAAG,CAAC,MAAM,CAAC;EAC7B,CAAC;EACDW,SAAS,EAAGP,IAAY,IAAK;IAC3B,IAAIA,IAAI,KAAKd,mBAAmB,CAACsB,SAAS,EAAE;MAC1CxB,QAAQ,CAAC,yCAAyC,EAAEgB,IAAI,CAAC;MACzD,OAAOb,QAAQ,CAACS,GAAG,CAACI,IAAI,CAAC,IAAIX,mBAAmB,CAACgB,YAAY,CAAC,CAAC;IACjE;IACA,OAAOlB,QAAQ,CAACS,GAAG,CAACI,IAAI,CAAC;EAC3B;AACF,CAAC;AACD,eAAeX,mBAAmB;AAClC,SAASH,mBAAmB"}
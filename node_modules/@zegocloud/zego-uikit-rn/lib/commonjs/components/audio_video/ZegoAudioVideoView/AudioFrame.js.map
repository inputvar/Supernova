{"version":3,"names":["_reactNative","require","_react","_interopRequireWildcard","_ZegoUIKitInternal","_interopRequireDefault","_reactDelegateComponent","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","defaultAvatarSizeRatio","flexStyle","AudioFrame","props","userInfo","showSoundWave","audioViewBackgroudColor","audioViewBackgroudImage","avatarBackgroundColor","avatarSize","avatarAlignment","avatarBuilder","soundWaveColor","avatar","soundLevel","setSoundLevel","useState","dimensions","setDimensions","width","height","isLoadError","setIsLoadError","getShotName","name","nl","split","shotName","forEach","part","substring","useEffect","callbackID","userID","String","Math","floor","random","ZegoUIKitInternal","onSoundLevelUpdate","createElement","View","style","cstyle","container","onLayout","event","nativeEvent","layout","ImageBackground","source","uri","resizeMode","styles","imgBackground","justifyContent","waveStyle","circleWave","subCircleWave","backgroundColor","Text","nameLabel","userName","Image","onLoadStart","console","log","onLoadEnd","onError","onLoad","alignItems","to","bgColor","StyleSheet","create","flex","position","w","color","opacity","alignSelf","aspectRatio","borderRadius","zIndex","alignContent","marginTop","marginBottom","toString","overflow","fontSize"],"sources":["AudioFrame.tsx"],"sourcesContent":["import { View, StyleSheet, Text, ImageBackground, Image } from 'react-native';\nimport React, { useState, useEffect } from 'react';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\nimport Delegate from 'react-delegate-component';\n\nconst defaultAvatarSizeRatio = 129 / 375;\nconst flexStyle = ['center', 'flex-start', 'flex-end'];\n\nexport default function AudioFrame(props: any) {\n  const {\n    userInfo,\n    showSoundWave,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    avatarBackgroundColor = '#DBDDE3',\n    avatarSize,\n    avatarAlignment,\n    avatarBuilder,\n    soundWaveColor = '#6B6A71',\n    avatar = '',\n  } = props;\n\n  const [soundLevel, setSoundLevel] = useState(0);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  const [isLoadError, setIsLoadError] = useState(false);\n\n  const getShotName = (name: string) => {\n    if (!name) {\n      return '';\n    }\n    const nl = name.split(' ');\n    var shotName = '';\n    nl.forEach((part) => {\n      if (part !== '') {\n        shotName += part.substring(0, 1);\n      }\n    });\n    return shotName;\n  };\n\n  useEffect(() => {\n    const callbackID = 'AudioFrame' + userInfo.userID + String(Math.floor(Math.random() * 10000));\n    ZegoUIKitInternal.onSoundLevelUpdate(\n      callbackID,\n      (userID: string, soundLevel: number) => {\n        if (userInfo.userID == userID) {\n          setSoundLevel(soundLevel);\n        }\n      }\n    );\n\n    return () => {\n      ZegoUIKitInternal.onSoundLevelUpdate(callbackID);\n    };\n  }, []);\n\n  return (\n    <View\n      style={\n        cstyle(audioViewBackgroudColor ? audioViewBackgroudColor : '#4A4B4D')\n          .container\n      }\n      onLayout={(event) => {\n        setDimensions({\n          width: event.nativeEvent.layout.width,\n          height: event.nativeEvent.layout.height,\n        });\n      }}\n    >\n      <ImageBackground\n        source={\n          audioViewBackgroudImage ? { uri: audioViewBackgroudImage } : null\n        }\n        resizeMode=\"cover\"\n        style={[\n          styles.imgBackground,\n          // @ts-ignore\n          { justifyContent: flexStyle[avatarAlignment] },\n        ]}\n      >\n        {showSoundWave && soundLevel > 5 ? (\n          <View\n            style={\n              waveStyle(\n                (avatarSize\n                  ? avatarSize.width\n                  : defaultAvatarSizeRatio * dimensions.width) +\n                  0.04 * dimensions.width,\n                soundWaveColor,\n                1\n              ).circleWave\n            }\n          >\n            {soundLevel > 10 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      0.06 * dimensions.width,\n                    soundWaveColor,\n                    0.6\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n            {soundLevel > 15 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      +0.08 * dimensions.width,\n                    soundWaveColor,\n                    0.3\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n          </View>\n        ) : (\n          <View />\n        )}\n        <View\n          style={[\n            styles.avatar,\n            {\n              backgroundColor: avatarBackgroundColor,\n              width: avatarSize\n                ? avatarSize.width\n                : defaultAvatarSizeRatio * dimensions.width,\n            },\n          ]}\n        >\n          {\n            !avatarBuilder ?\n              (!avatar || isLoadError) ?\n                <Text style={styles.nameLabel}>{getShotName(userInfo.userName)}</Text> :\n                <Image \n                  style={{ width: '100%', height: '100%', resizeMode: 'contain' }}\n                  resizeMode=\"contain\"\n                  source={{ uri: avatar }}\n                  onLoadStart={() =>  console.log('avatar onLoadStart')}\n                  onLoadEnd={() =>  console.log('avatar onLoadEnd')}\n                  onError={() =>  { console.log('avatar onError'); setIsLoadError(true);}}\n                  onLoad={() =>  { console.log('avatar onLoad'); setIsLoadError(false);}}\n                />\n              : <View style={{ width: '100%', height: '100%', alignItems: 'center', justifyContent: 'center', }}>\n                {\n                  (!avatar || isLoadError) ? <Text style={styles.nameLabel}>{getShotName(userInfo.userName)}</Text> : null\n                }\n                <Delegate\n                  to={avatarBuilder}\n                  props={{ userInfo: userInfo }}\n                />\n              </View>\n          }\n        </View>\n      </ImageBackground>\n    </View>\n  );\n}\n\nconst cstyle = (bgColor: string) =>\n  StyleSheet.create({\n    container: {\n      flex: 1,\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      justifyContent: 'center',\n      backgroundColor: bgColor,\n    },\n  });\nconst waveStyle = (w: number, color: string, opacity: number) =>\n  StyleSheet.create({\n    circleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 375) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n      justifyContent: 'center',\n      alignContent: 'center',\n    },\n    subCircleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 164) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n    },\n  });\nconst styles = StyleSheet.create({\n  imgBackground: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  avatar: {\n    flex: 1,\n    marginTop: 1.5,\n    marginBottom: 1.5,\n    width: ((129 / 375) * 100).toString() + '%',\n    aspectRatio: 1,\n    borderRadius: 1000,\n    position: 'absolute',\n    alignSelf: 'center',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 2,\n    overflow: 'hidden',\n  },\n  nameLabel: {\n    flex: 1,\n    position: 'absolute',\n    color: '#222222',\n    fontSize: 22,\n  },\n});\n"],"mappings":"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"}
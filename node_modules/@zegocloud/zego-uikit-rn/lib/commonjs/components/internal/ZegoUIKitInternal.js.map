{"version":3,"names":["_zegoExpressEngineReactnative","_interopRequireDefault","require","_logger","_defines","obj","__esModule","default","_appInfo","appID","appSign","_isRoomConnected","_currentRoomState","_currentRoomID","_audioOutputType","_usingFrontFacingCamera","_onMicDeviceOnCallbackMap","_onCameraDeviceOnCallbackMap","_onRoomStateChangedCallbackMap","_onRequireNewTokenCallbackMap","_onUserJoinCallbackMap","_onUserLeaveCallbackMap","_onUserInfoUpdateCallbackMap","_onSoundLevelUpdateCallbackMap","_onSDKConnectedCallbackMap","_onAudioOutputDeviceTypeChangeCallbackMap","_onOnlySelfInRoomCallbackMap","_onUserCountOrPropertyChangedCallbackMap","_onAudioVideoAvailableCallbackMap","_onAudioVideoUnavailableCallbackMap","_onInRoomMessageReceivedCallbackMap","_onInRoomMessageSentCallbackMap","_onRoomPropertyUpdatedCallbackMap","_onRoomPropertiesFullUpdatedCallbackMap","_onInRoomCommandReceivedCallbackMap","_onMeRemovedFromRoomCallbackMap","_onTurnOnYourCameraRequestCallbackMap","_onTurnOnYourMicrophoneRequestCallbackMap","_onMemberListForceSortCallbackMap","_onAudioVideoListForceSortCallbackMap","_onVideoViewForceRenderCallbackMap","_localCoreUser","_createCoreUser","_streamCoreUserMap","_coreUserMap","_qualityUpdateLogCounter","_inRoomMessageList","_audioVideoResourceMode","ZegoAudioVideoResourceMode","Default","_roomProperties","_isLargeRoom","_roomMemberCount","_markAsLargeRoom","_onErrorCallbackMap","_resetData","zloginfo","_resetDataForLeavingRoom","userID","userName","profileUrl","extendInfo","_createPublicUser","coreUser","isMicrophoneOn","isMicDeviceOn","isCameraOn","isCameraDeviceOn","soundLevel","inRoomAttributes","avatar","viewID","viewFillMode","streamID","publisherQuality","joinTime","_isLocalUser","undefined","_setLocalUserInfo","userInfo","_onRoomUserUpdate","roomID","updateType","userList","userInfoList","length","forEach","user","_getStreamIDByUserID","Date","now","_notifyUserInfoUpdate","push","_tryStartPlayStream","_notifyUserCountOrPropertyChanged","ZegoChangedCountOrProperty","userAdd","Object","keys","callbackID","_tryStopPlayStream","userDelete","_onRoomStreamUpdate","streamList","users","stream","cameraStateUpdate","_onRemoteCameraStateUpdate","isOn","_onAudioRouteChange","type","_onRemoteMicStateUpdate","microphoneStateUpdate","_onRoomStateChanged","reason","errorCode","extendedData","_tryStartPublishStream","_notifyMeRemovedFromRoom","_onInRoomMessageReceived","messageList","messages","msg","message","messageID","sendTime","sender","fromUser","_onRequireNewToken","token","ZegoExpressEngine","instance","renewToken","then","catch","error","zlogerror","_onRoomExtraInfoUpdate","roomExtraInfoList","updateKeys","oldRoomProperties","JSON","parse","stringify","_ref","key","updateTime","updateUser","value","roomProperties","propertyKey","_notifyRoomPropertyUpdate","ZegoRoomPropertyUpdateType","remote","_notifyRoomPropertiesFullUpdate","_onIMCustomCommandReceived","command","commandObj","removeUserIDList","zego_remove_user","turnCameraOnUserID","zego_turn_camera_on","turnCameraOffUserID","zego_turn_camera_off","turnMicrophoneOnUserID","zego_turn_microphone_on","turnMicrophoneOffUserID","zego_turn_microphone_off","find","removeUserID","_leaveRoom","_turnCameraDeviceOn","_turnMicDeviceOn","console","_sendInRoomCommand","toUserList","Promise","reject","resolve","sendCustomCommand","_ref2","zlogwarning","logoutRoom","stopSoundLevelMonitor","on","muteMicrophone","extraInfo","setStreamExtraInfo","_tryStopPublishStream","isLargeRoom","enableCamera","_registerEngineCallback","quality","split","state","_getUserIDByStreamID","soundLevels","_notifySoundLevelUpdate","audioRoute","remainTimeInSecond","_unregisterEngineCallback","off","values","sort","user1","user2","map","_getPublishStreamID","startPublishingStream","startPreview","reactTag","viewMode","fillMode","backgroundColor","force","arguments","stopPublishingStream","stopPreview","startPlayingStream","resourceMode","stopPlayingStream","oldValue","_isEngineCreated","_default","exports","isRoomConnected","setAudioVideoResourceMode","audioVideoResourceMode","updateRenderingProperty","onUserInfoUpdate","callback","onSoundLevelUpdate","onSDKConnected","connectSDK","setEngineConfig","advancedConfig","notify_remote_device_unknown_status","notify_remote_device_init_status","engineProfile","scenario","createEngineWithProfile","engine","disconnectSDK","destroyEngine","finally","useFrontFacingCamera","isFrontFacing","useFrontCamera","isUsingFrontFacingCamera","enableSpeaker","enable","muteSpeaker","audioOutputDeviceType","turnMicDeviceOn","turnCameraDeviceOn","onMicDeviceOn","onCameraDeviceOn","setAudioOutputToSpeaker","isSpeaker","setAudioRouteToSpeaker","onAudioOutputDeviceTypeChange","setAudioConfig","config","setVideoConfig","onAudioVideoAvailable","onAudioVideoUnavailable","startPlayingAllAudioVideo","muteAllPlayStreamAudio","muteAllPlayStreamVideo","stopPlayingAllAudioVideo","onTurnOnYourCameraRequest","onTurnOnYourMicrophoneRequest","joinRoom","markAsLargeRoom","isUserStatusNotify","loginRoom","startSoundLevelMonitor","leaveRoom","onRoomStateChanged","onRequireNewToken","setRoomProperty","setRoomExtraInfo","_ref3","set","code","updateRoomProperties","newRoomProperties","_ref4","updateKey","update","getRoomProperties","onRoomPropertyUpdated","onRoomPropertiesFullUpdated","sendInRoomCommand","toUserIDs","onInRoomCommandReceived","onMeRemovedFromRoom","connectUser","disconnectUser","getLocalUserInfo","getUser","getAllUsers","a","b","publicUsers","onUserJoin","onUserLeave","onOnlySelfInRoom","onUserCountOrPropertyChanged","removeUserFromRoom","userIDs","getInRoomMessages","sendInRoomMessage","sendBroadcastMessage","result","inRoomMessage","onInRoomMessageReceived","onInRoomMessageSent","notifyUserCountOrPropertyChanged","notifyUserInfoUpdate","forceSortMemberList","onMemberListForceSort","forceSortAudioVideoList","onAudioVideoListForceSort","forceRenderVideoView","onVideoViewForceRender","onError","notifyErrorUpdate","method"],"sources":["ZegoUIKitInternal.ts"],"sourcesContent":["import ZegoExpressEngine, {\n  ZegoRoomStateChangedReason,\n  ZegoAudioRoute,\n  ZegoUser,\n  ZegoEngineProfile,\n  ZegoRoomConfig,\n} from 'zego-express-engine-reactnative';\nimport { zlogerror, zloginfo, zlogwarning } from '../../utils/logger';\nimport { ZegoAudioVideoResourceMode, ZegoChangedCountOrProperty, ZegoRoomPropertyUpdateType } from './defines'\n\nvar _appInfo = {\n  appID: 0,\n  appSign: '',\n};\nvar _isRoomConnected = false;\nvar _currentRoomState = 7; // Logout\nvar _currentRoomID = '';\nvar _audioOutputType = 0;\nvar _usingFrontFacingCamera = true;\n\nvar _onMicDeviceOnCallbackMap: any = {};\nvar _onCameraDeviceOnCallbackMap: any = {};\nvar _onRoomStateChangedCallbackMap: any = {};\nvar _onRequireNewTokenCallbackMap: any = {};\nvar _onUserJoinCallbackMap: any = {};\nvar _onUserLeaveCallbackMap: any = {};\nvar _onUserInfoUpdateCallbackMap: any = {};\nvar _onSoundLevelUpdateCallbackMap: any = {};\nvar _onSDKConnectedCallbackMap: any = {};\nvar _onAudioOutputDeviceTypeChangeCallbackMap: any = {};\nvar _onOnlySelfInRoomCallbackMap: any = {};\nvar _onUserCountOrPropertyChangedCallbackMap: any = {};\nvar _onAudioVideoAvailableCallbackMap: any = {};\nvar _onAudioVideoUnavailableCallbackMap: any = {};\nvar _onInRoomMessageReceivedCallbackMap: any = {};\nvar _onInRoomMessageSentCallbackMap: any = {};\nvar _onRoomPropertyUpdatedCallbackMap: any = {};\nvar _onRoomPropertiesFullUpdatedCallbackMap: any = {};\nvar _onInRoomCommandReceivedCallbackMap: any = {};\nvar _onMeRemovedFromRoomCallbackMap: any = {};\nvar _onTurnOnYourCameraRequestCallbackMap: any = {};\nvar _onTurnOnYourMicrophoneRequestCallbackMap: any = {};\n\n// Force update component callback\nvar _onMemberListForceSortCallbackMap: any = {};\nvar _onAudioVideoListForceSortCallbackMap: any = {};\nvar _onVideoViewForceRenderCallbackMap: any = {};\n\nvar _localCoreUser: any = _createCoreUser('', '', '', {});\nvar _streamCoreUserMap: any = {}; // <streamID, CoreUser>\nvar _coreUserMap: any = {}; // <userID, CoreUser>\nvar _qualityUpdateLogCounter = 0;\n\nvar _inRoomMessageList: any[] = [];\nvar _audioVideoResourceMode = ZegoAudioVideoResourceMode.Default;\nvar _roomProperties: any = {};\nvar _isLargeRoom = false;\nvar _roomMemberCount = 0;\nvar _markAsLargeRoom = false;\n\nvar _onErrorCallbackMap: any = {};\n\nfunction _resetData() {\n  zloginfo('Reset all data.');\n  _appInfo = { appID: 0, appSign: '' };\n  _localCoreUser = _createCoreUser('', '', '', {});\n  _streamCoreUserMap = {};\n  _coreUserMap = {};\n  _currentRoomID = '';\n  _currentRoomState = 7;\n  _isRoomConnected = false;\n  _audioOutputType = 0;\n  _inRoomMessageList = [];\n  _audioVideoResourceMode = ZegoAudioVideoResourceMode.Default;\n  _isLargeRoom = false;\n  _roomMemberCount = 0;\n  _markAsLargeRoom = false;\n}\n\nfunction _resetDataForLeavingRoom() {\n  zloginfo('Reset data for leaving room.');\n  _streamCoreUserMap = {};\n  _coreUserMap = {};\n  _currentRoomID = '';\n  _currentRoomState = 7;\n  _isRoomConnected = false;\n  const { userID, userName, profileUrl, extendInfo } = _localCoreUser;\n  _localCoreUser = _createCoreUser(userID, userName, profileUrl, extendInfo);\n  _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n  _inRoomMessageList = [];\n  _roomProperties = {};\n  _isLargeRoom = false;\n  _roomMemberCount = 0;\n  _markAsLargeRoom = false;\n}\n\nfunction _createPublicUser(coreUser: any) {\n  return {\n    userID: coreUser.userID,\n    userName: coreUser.userName,\n    extendInfo: coreUser.extendInfo,\n    isMicrophoneOn: coreUser.isMicDeviceOn,\n    isCameraOn: coreUser.isCameraDeviceOn,\n    soundLevel: coreUser.soundLevel,\n    inRoomAttributes: coreUser.inRoomAttributes,\n    avatar: coreUser.avatar,\n  };\n}\nfunction _createCoreUser(userID: string, userName: string, profileUrl?: string, extendInfo?: any) {\n  return {\n    userID: userID,\n    userName: userName,\n    profileUrl: profileUrl,\n    extendInfo: extendInfo,\n    viewID: -1,\n    viewFillMode: 1,\n    streamID: '',\n    isMicDeviceOn: false,\n    isCameraDeviceOn: false,\n    publisherQuality: 0,\n    soundLevel: 0,\n    joinTime: 0,\n    inRoomAttributes: {},\n    avatar: '',\n  };\n}\nfunction _isLocalUser(userID: string) {\n  return (\n    userID === undefined || userID === '' || _localCoreUser.userID === userID\n  );\n}\nfunction _setLocalUserInfo(userInfo: any) {\n  _localCoreUser = _createCoreUser(\n    userInfo.userID,\n    userInfo.userName,\n    userInfo.profileUrl,\n    userInfo.extendInfo\n  );\n  _coreUserMap[userInfo.userID] = _localCoreUser;\n}\n\nfunction _onRoomUserUpdate(roomID: string, updateType: number, userList: any[]) {\n  // No need for roomID, does not support multi-room right now.\n  const userInfoList: any[] = [];\n  if (updateType == 0) {\n    _roomMemberCount += userList.length;\n    if (_roomMemberCount >= 500) {\n      _isLargeRoom = true;\n    }\n    userList.forEach((user) => {\n      if (!(user.userID in _coreUserMap)) {\n        const coreUser = _createCoreUser(user.userID, user.userName);\n        _coreUserMap[user.userID] = coreUser;\n      }\n      const streamID = _getStreamIDByUserID(user.userID);\n      if (streamID in _streamCoreUserMap) {\n        _coreUserMap[user.userID].streamID = streamID;\n      }\n      _coreUserMap[user.userID].joinTime = Date.now();\n      _notifyUserInfoUpdate(_coreUserMap[user.userID]);\n\n      userInfoList.push(_createPublicUser(_coreUserMap[user.userID]));\n\n      // Start after user insert into list\n      _tryStartPlayStream(user.userID);\n    });\n    _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userAdd);\n\n    zloginfo('User Join: ', userInfoList);\n    Object.keys(_onUserJoinCallbackMap).forEach((callbackID) => {\n      if (_onUserJoinCallbackMap[callbackID]) {\n        _onUserJoinCallbackMap[callbackID](userInfoList);\n      }\n    });\n  } else {\n    _roomMemberCount -= userList.length;\n    userList.forEach((user) => {\n      if (user.userID in _coreUserMap) {\n        const coreUser = _coreUserMap[user.userID];\n        const userInfo = {\n          userID: coreUser.userID,\n          userName: coreUser.userName,\n          profileUrl: coreUser.profileUrl,\n          extendInfo: coreUser.extendInfo,\n        };\n        userInfoList.push(userInfo);\n\n        // Stop play stream before remove user list\n        _tryStopPlayStream(coreUser.userID, true);\n        delete _coreUserMap[user.userID];\n      }\n    });\n    _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userDelete);\n    zloginfo('User Leave: ', userInfoList);\n    Object.keys(_onUserLeaveCallbackMap).forEach((callbackID) => {\n      if (_onUserLeaveCallbackMap[callbackID]) {\n        _onUserLeaveCallbackMap[callbackID](userInfoList);\n      }\n    });\n    if (Object.keys(_coreUserMap).length <= 1) {\n      Object.keys(_onOnlySelfInRoomCallbackMap).forEach((callbackID) => {\n        if (_onOnlySelfInRoomCallbackMap[callbackID]) {\n          _onOnlySelfInRoomCallbackMap[callbackID]();\n        }\n      });\n    }\n  }\n}\nfunction _onRoomStreamUpdate(roomID: string, updateType: number, streamList: any[]) {\n  zloginfo('_onRoomStreamUpdate: ', roomID, updateType, streamList);\n  var users: any[] = [];\n  if (updateType == 0) {\n    // Add\n    streamList.forEach((stream) => {\n      const userID = stream.user.userID;\n      const userName = stream.user.userName;\n      const streamID = stream.streamID;\n      if (userID in _coreUserMap) {\n        _coreUserMap[userID].streamID = streamID;\n        _streamCoreUserMap[streamID] = _coreUserMap[userID];\n        _notifyUserInfoUpdate(_coreUserMap[userID]);\n        _tryStartPlayStream(userID);\n\n        users.push(_coreUserMap[userID]);\n      } else {\n        _streamCoreUserMap[streamID] = _createCoreUser(\n          userID,\n          userName,\n          '',\n          {}\n        );\n        _streamCoreUserMap[streamID].streamID = streamID;\n\n        _coreUserMap[userID] = _streamCoreUserMap[streamID];\n\n        users.push(_streamCoreUserMap[streamID]);\n      }\n    });\n\n    Object.keys(_onAudioVideoAvailableCallbackMap).forEach((callbackID) => {\n      if (_onAudioVideoAvailableCallbackMap[callbackID]) {\n        _onAudioVideoAvailableCallbackMap[callbackID](users);\n      }\n    });\n  } else {\n    streamList.forEach((stream) => {\n      const userID = stream.user.userID;\n      const streamID = stream.streamID;\n      if (userID in _coreUserMap) {\n        _tryStopPlayStream(userID, true);\n        _coreUserMap[userID].isCameraDeviceOn = false;\n        _coreUserMap[userID].isMicDeviceOn = false;\n        _coreUserMap[userID].streamID = '';\n        _notifyUserInfoUpdate(_coreUserMap[userID]);\n\n        users.push(_coreUserMap[userID]);\n\n        delete _streamCoreUserMap[streamID];\n      }\n    });\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.cameraStateUpdate\n    );\n\n    Object.keys(_onAudioVideoUnavailableCallbackMap).forEach((callbackID) => {\n      if (_onAudioVideoUnavailableCallbackMap[callbackID]) {\n        _onAudioVideoUnavailableCallbackMap[callbackID](users);\n      }\n    });\n  }\n}\nfunction _onRemoteCameraStateUpdate(userID: string, isOn: boolean) {\n  if (userID in _coreUserMap) {\n    _coreUserMap[userID].isCameraDeviceOn = isOn;\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.cameraStateUpdate\n    );\n\n    Object.keys(_onCameraDeviceOnCallbackMap).forEach((callbackID) => {\n      if (_onCameraDeviceOnCallbackMap[callbackID]) {\n        _onCameraDeviceOnCallbackMap[callbackID](userID, isOn);\n      }\n    });\n\n    if (userID != _localCoreUser.userID) {\n      if (isOn) {\n        _tryStartPlayStream(userID);\n      }\n    }\n  }\n}\nfunction _onAudioRouteChange(type: ZegoAudioRoute) {\n  Object.keys(_onAudioOutputDeviceTypeChangeCallbackMap).forEach(\n    (callbackID) => {\n      if (_onAudioOutputDeviceTypeChangeCallbackMap[callbackID]) {\n        _onAudioOutputDeviceTypeChangeCallbackMap[callbackID](type);\n      }\n    }\n  );\n  _audioOutputType = type;\n}\nfunction _onRemoteMicStateUpdate(userID: string, isOn: boolean) {\n  if (userID in _coreUserMap) {\n    _coreUserMap[userID].isMicDeviceOn = isOn;\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.microphoneStateUpdate\n    );\n\n    Object.keys(_onMicDeviceOnCallbackMap).forEach((callbackID) => {\n      if (_onMicDeviceOnCallbackMap[callbackID]) {\n        _onMicDeviceOnCallbackMap[callbackID](userID, isOn);\n      }\n    });\n\n    if (userID != _localCoreUser.userID) {\n      if (isOn) {\n        _tryStartPlayStream(userID);\n      }\n    }\n  }\n}\nfunction _onRoomStateChanged(roomID: string, reason: ZegoRoomStateChangedReason, errorCode: number, extendedData: string) {\n  zloginfo('Room state chaged: ', roomID, reason, errorCode, extendedData);\n  // Not support multi-room right now\n  if (reason == 1 || reason == 4) {\n    // Logined || Reconnected\n    _isRoomConnected = true;\n    _tryStartPublishStream();\n  } else {\n    _isRoomConnected = false;\n    if (reason == 6) {\n      // KickOut\n      _notifyMeRemovedFromRoom();\n    }\n  }\n  _currentRoomState = reason;\n\n  Object.keys(_onRoomStateChangedCallbackMap).forEach((callbackID) => {\n    // callback may remove from map during room state chaging\n    if (callbackID in _onRoomStateChangedCallbackMap) {\n      if (_onRoomStateChangedCallbackMap[callbackID]) {\n        _onRoomStateChangedCallbackMap[callbackID](\n          reason,\n          errorCode,\n          extendedData\n        );\n      }\n    }\n  });\n}\nfunction _onInRoomMessageReceived(roomID: string, messageList: any[]) {\n  zloginfo('Received in room message: ', roomID, messageList.length);\n  var messages: any[] = [];\n  messageList.forEach((msg) => {\n    const message = {\n      message: msg.message,\n      messageID: msg.messageID,\n      sendTime: msg.sendTime,\n      sender: _createPublicUser(_coreUserMap[msg.fromUser.userID]),\n    };\n    messages.push(message);\n    _inRoomMessageList.push(message);\n  });\n\n  Object.keys(_onInRoomMessageReceivedCallbackMap).forEach((callbackID) => {\n    // callback may remove from map during room state chaging\n    if (callbackID in _onInRoomMessageReceivedCallbackMap) {\n      if (_onInRoomMessageReceivedCallbackMap[callbackID]) {\n        _onInRoomMessageReceivedCallbackMap[callbackID](messages);\n      }\n    }\n  });\n}\nfunction _onRequireNewToken() {\n  Object.keys(_onRequireNewTokenCallbackMap).forEach((callbackID) => {\n    if (callbackID in _onRequireNewTokenCallbackMap) {\n      if (_onRequireNewTokenCallbackMap[callbackID]) {\n        const token = _onRequireNewTokenCallbackMap[callbackID]();\n        if (token) {\n          ZegoExpressEngine.instance()\n            .renewToken(_currentRoomID, token)\n            .then(() => {\n              zloginfo('Renew token success');\n            })\n            .catch((error) => {\n              zlogerror('Renew token failed: ', error);\n            });\n        } else {\n          zlogerror('Renew token failed: the returned token is abnormal');\n        }\n      }\n    }\n  });\n}\nfunction _onRoomExtraInfoUpdate(roomID: string, roomExtraInfoList: any[]) {\n  zloginfo('$$$$$$$$Room extra info update: ', roomID, roomExtraInfoList);\n  const updateKeys: string[]= [];\n  const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n  roomExtraInfoList.forEach(({ key, updateTime, updateUser, value }) => {\n    if (key === 'extra_info') {\n      const roomProperties = JSON.parse(value);\n      Object.keys(roomProperties).forEach((propertyKey) => {\n        if (oldRoomProperties[propertyKey] !== roomProperties[propertyKey]) {\n          updateKeys.push(propertyKey);\n          _roomProperties[propertyKey] = roomProperties[propertyKey];\n          _notifyRoomPropertyUpdate(propertyKey, oldRoomProperties[propertyKey], roomProperties[propertyKey], ZegoRoomPropertyUpdateType.remote);\n        }\n      })\n    }\n  });\n  if (updateKeys.length > 0) {\n    _notifyRoomPropertiesFullUpdate(updateKeys, oldRoomProperties, JSON.parse(JSON.stringify(_roomProperties)), ZegoRoomPropertyUpdateType.remote);\n  }\n}\nfunction _onIMCustomCommandReceived(roomID: string, fromUser: ZegoUser, command: string) {\n  try {\n    const commandObj = JSON.parse(command);\n    if (commandObj && typeof commandObj === 'object') {\n      fromUser = _createPublicUser(_coreUserMap[fromUser.userID] || fromUser);\n      const removeUserIDList = commandObj.zego_remove_user;\n      const turnCameraOnUserID = commandObj.zego_turn_camera_on;\n      const turnCameraOffUserID = commandObj.zego_turn_camera_off;\n      const turnMicrophoneOnUserID = commandObj.zego_turn_microphone_on;\n      const turnMicrophoneOffUserID = commandObj.zego_turn_microphone_off;\n      if (removeUserIDList && removeUserIDList.find((removeUserID: string) => removeUserID === _localCoreUser.userID)) {\n        _notifyMeRemovedFromRoom();\n        // Leave the room automatically\n        _leaveRoom();\n      } else if (turnCameraOnUserID === _localCoreUser.userID) {\n        Object.keys(_onTurnOnYourCameraRequestCallbackMap).forEach((callbackID) => {\n          if (_onTurnOnYourCameraRequestCallbackMap[callbackID]) {\n            _onTurnOnYourCameraRequestCallbackMap[callbackID](fromUser);\n          }\n        });\n      } else if (turnMicrophoneOnUserID === _localCoreUser.userID) {\n        Object.keys(_onTurnOnYourMicrophoneRequestCallbackMap).forEach((callbackID) => {\n          if (_onTurnOnYourMicrophoneRequestCallbackMap[callbackID]) {\n            _onTurnOnYourMicrophoneRequestCallbackMap[callbackID](fromUser);\n          }\n        });\n      } else if (turnCameraOffUserID === _localCoreUser.userID) {\n        _turnCameraDeviceOn(_localCoreUser.userID, false);\n        // Automatic shutdown\n      } else if (turnMicrophoneOffUserID === _localCoreUser.userID) {\n        // Automatic shutdown\n        _turnMicDeviceOn(_localCoreUser.userID, false);\n      }\n    }\n  } catch (error) {\n    console.error(error);\n  }\n  zloginfo('_onIMCustomCommandReceived: ', roomID, fromUser, command);\n  Object.keys(_onInRoomCommandReceivedCallbackMap).forEach((callbackID) => {\n    if (callbackID in _onInRoomCommandReceivedCallbackMap) {\n      if (_onInRoomCommandReceivedCallbackMap[callbackID]) {\n        _onInRoomCommandReceivedCallbackMap[callbackID](fromUser, command);\n      }\n    }\n  });\n}\nfunction _sendInRoomCommand(command: string, toUserList: any[]) {\n  if (!_isRoomConnected) {\n    zlogerror('You need to join the room before using this interface!');\n    return Promise.reject();\n  }\n  return new Promise<void>((resolve, reject) => {\n    ZegoExpressEngine.instance().sendCustomCommand(_currentRoomID, command, toUserList).then(({ errorCode }) => {\n      if (errorCode === 0) {\n        zloginfo('[sendInRoomCommand]Send successfully', toUserList);\n        resolve();\n      } else {\n        zloginfo('[sendInRoomCommand]Send failure', toUserList);\n        reject();\n      }\n    }).catch((error) => {\n      zloginfo('[sendInRoomCommand]Send error', error);\n      reject();\n    })\n  });\n}\nfunction _leaveRoom() {\n  return new Promise<void>((resolve, reject) => {\n    if (_currentRoomID == '') {\n      zlogwarning('You are not join in any room, no need to leave room.');\n      resolve();\n    } else {\n      zloginfo('leaveRoom: ', _currentRoomID);\n      ZegoExpressEngine.instance()\n        .logoutRoom(_currentRoomID)\n        .then(() => {\n          zloginfo('Leave room succeed.');\n          ZegoExpressEngine.instance().stopSoundLevelMonitor();\n          _notifyUserCountOrPropertyChanged(\n            ZegoChangedCountOrProperty.userDelete\n          );\n          _resetDataForLeavingRoom();\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Leave room failed: ', error);\n          reject(error);\n        });\n    }\n  });\n}\nfunction _turnMicDeviceOn(userID: string, on: boolean) {\n  return new Promise<void>((resolve, reject) => {\n    if (_isLocalUser(userID)) {\n      zloginfo('turnMicDeviceOn: ', _localCoreUser.userID, on);\n      ZegoExpressEngine.instance().muteMicrophone(!on);\n\n      _onRemoteMicStateUpdate(_localCoreUser.userID, on);\n\n      _localCoreUser.isMicDeviceOn = on;\n      _coreUserMap[_localCoreUser.userID].isMicDeviceOn = on;\n      _notifyUserInfoUpdate(_localCoreUser);\n      _notifyUserCountOrPropertyChanged(\n        ZegoChangedCountOrProperty.microphoneStateUpdate\n      );\n\n      // sync device status via stream extra info\n      var extraInfo = {\n          isCameraOn : _localCoreUser.isCameraDeviceOn,\n          isMicrophoneOn : on\n      }\n      ZegoExpressEngine.instance().setStreamExtraInfo(JSON.stringify(extraInfo))\n\n      if (on) {\n        _tryStartPublishStream();\n      } else {\n        _tryStopPublishStream();\n      }\n      resolve();\n    } else {\n      const isLargeRoom = _isLargeRoom || _markAsLargeRoom;\n      const command = on ? JSON.stringify({ zego_turn_microphone_on: userID }) : JSON.stringify({ zego_turn_microphone_off: userID });\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      const toUserList = isLargeRoom ? [] : [{ userID, userName }];\n      _sendInRoomCommand(command, toUserList).then(() => {\n        zloginfo('turnMicDeviceOn others: ', userID, on);\n        resolve();\n      }).catch(() => {\n        zlogerror('turnMicDeviceOn others error: ', userID, on);\n        reject();\n      });\n    }\n  });\n}\nfunction _turnCameraDeviceOn(userID: string, on: boolean) {\n  return new Promise<void>((resolve, reject) => {\n    if (_isLocalUser(userID)) {\n      // Default to Main Channel\n      zloginfo('turnCameraDeviceOn: ', _localCoreUser.userID, on);\n      ZegoExpressEngine.instance().enableCamera(on, 0);\n\n      _onRemoteCameraStateUpdate(_localCoreUser.userID, on);\n\n      _localCoreUser.isCameraDeviceOn = on;\n      // if (!on) {\n      //     _localCoreUser.viewID = -1;\n      // }\n      _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n      _notifyUserInfoUpdate(_localCoreUser);\n      _notifyUserCountOrPropertyChanged(\n        ZegoChangedCountOrProperty.cameraStateUpdate\n      );\n\n      // sync device status via stream extra info\n      var extraInfo = {\n          isCameraOn : on,\n          isMicrophoneOn : _localCoreUser.isMicDeviceOn\n      }\n      ZegoExpressEngine.instance().setStreamExtraInfo(JSON.stringify(extraInfo))\n\n      if (on) {\n        _tryStartPublishStream();\n      } else {\n        _tryStopPublishStream();\n      }\n      resolve();\n    } else {\n      const isLargeRoom = _isLargeRoom || _markAsLargeRoom;\n      const command = on ? JSON.stringify({ zego_turn_camera_on: userID }) : JSON.stringify({ zego_turn_camera_off: userID });\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      const toUserList = isLargeRoom ? [] : [{ userID, userName }];\n      _sendInRoomCommand(command, toUserList).then(() => {\n        zloginfo('turnCameraDeviceOn others: ', userID, on);\n        resolve();\n      }).catch(() => {\n        zlogerror('turnCameraDeviceOn others error: ', userID, on);\n        reject();\n      });\n    }\n  });\n}\nfunction _registerEngineCallback() {\n  zloginfo('Register callback for ZegoExpressEngine...');\n  ZegoExpressEngine.instance().on(\n    'roomUserUpdate',\n    (roomID, updateType, userList) => {\n      zloginfo('[roomUserUpdate callback]', roomID, updateType, userList);\n      _onRoomUserUpdate(roomID, updateType, userList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'roomStreamUpdate',\n    (roomID, updateType, streamList) => {\n      zloginfo('[roomStreamUpdate callback]', roomID, updateType, streamList);\n      _onRoomStreamUpdate(roomID, updateType, streamList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'publisherQualityUpdate',\n    (streamID, quality) => {\n      if (_qualityUpdateLogCounter % 10 == 0) {\n        _qualityUpdateLogCounter = 0;\n        zloginfo('[publisherQualityUpdate callback]', streamID, quality);\n      }\n      _qualityUpdateLogCounter++;\n      if (streamID.split('_')[2] === 'main') {\n        _localCoreUser.publisherQuality = quality;\n        _coreUserMap[_localCoreUser.userID].publisherQuality = quality;\n        _notifyUserInfoUpdate(_coreUserMap[_localCoreUser.userID]);\n      }\n    }\n  );\n  // ZegoExpressEngine.instance().on(\n  //     'publisherStateUpdate',\n  //     (streamID, state, errorCode, extendedData) => {\n  //         zloginfo('publisherStateUpdate#################', streamID, state, errorCode)\n  //     },\n  // );\n  ZegoExpressEngine.instance().on(\n    'playerQualityUpdate',\n    (streamID, quality) => {\n      if (_qualityUpdateLogCounter % 10 == 0) {\n        // zloginfo('[playerQualityUpdate callback]', streamID, quality);\n      }\n      // TODO\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'remoteCameraStateUpdate',\n    (streamID, state) => {\n      zloginfo('[remoteCameraStateUpdate callback]', streamID, state);\n      // 0 for device is on\n      _onRemoteCameraStateUpdate(_getUserIDByStreamID(streamID), state == 0);\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteMicStateUpdate', (streamID, state) => {\n    zloginfo('[remoteMicStateUpdate callback]', streamID, state);\n    // 0 for device is on\n    _onRemoteMicStateUpdate(_getUserIDByStreamID(streamID), state == 0);\n  });\n  ZegoExpressEngine.instance().on(\n    'playerStateUpdate',\n    (streamID, state, errorCode, extendedData) => {\n      zloginfo(\n        '[playerStateUpdate callback]',\n        streamID,\n        state,\n        errorCode,\n        extendedData\n      );\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteSoundLevelUpdate', (soundLevels: any) => {\n    // {streamID, soundLavel} value from 0.0 to 100.0\n    // zloginfo('[remoteSoundLevelUpdate callback]', soundLevels);\n    Object.keys(soundLevels).forEach((streamID) => {\n      const userID = _getUserIDByStreamID(streamID);\n      if (userID in _coreUserMap) {\n        _coreUserMap[userID].soundLevel = soundLevels[streamID];\n        _notifySoundLevelUpdate(userID, soundLevels[streamID]);\n      }\n    });\n  });\n  ZegoExpressEngine.instance().on('capturedSoundLevelUpdate', (soundLevel) => {\n    if (\n      _localCoreUser.userID === '' ||\n      !(_localCoreUser.userID in _coreUserMap)\n    ) {\n      return;\n    }\n    _localCoreUser.soundLevel = soundLevel;\n    _coreUserMap[_localCoreUser.userID].soundLevel = soundLevel;\n    _notifySoundLevelUpdate(_localCoreUser.userID, soundLevel);\n    // zloginfo('capturedSoundLevelUpdate', soundLevel)\n  });\n  // https://doc-en-api.zego.im/ReactNative/enums/_zegoexpressdefines_.zegoroomstatechangedreason.html\n  ZegoExpressEngine.instance().on(\n    'roomStateChanged',\n    (roomID, reason, errorCode, extendedData) => {\n      zloginfo(\n        '[roomStateChanged callback]',\n        roomID,\n        reason,\n        errorCode,\n        extendedData\n      );\n      _onRoomStateChanged(roomID, reason, errorCode, extendedData);\n    }\n  );\n  ZegoExpressEngine.instance().on('audioRouteChange', (audioRoute) => {\n    zloginfo('[audioRouteChange callback]', audioRoute);\n    _onAudioRouteChange(audioRoute);\n  });\n  ZegoExpressEngine.instance().on(\n    'IMRecvBroadcastMessage',\n    (roomID, messageList) => {\n      _onInRoomMessageReceived(roomID, messageList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'roomTokenWillExpire',\n    (roomID, remainTimeInSecond) => {\n      _onRequireNewToken();\n    }\n  );\n  ZegoExpressEngine.instance().on('roomExtraInfoUpdate', (roomID, roomExtraInfoList) => {\n    _onRoomExtraInfoUpdate(roomID, roomExtraInfoList);\n  });\n  ZegoExpressEngine.instance().on('roomStreamExtraInfoUpdate', (roomID, streamList) => {\n    zloginfo('roomStreamExtraInfoUpdate', streamList)\n    streamList.forEach((stream) => {\n        try {\n            var extraInfo = JSON.parse(stream.extraInfo)\n            if ('isCameraOn' in extraInfo) {\n                _onRemoteCameraStateUpdate(stream.user.userID, extraInfo.isCameraOn)\n            }\n            if ('isMicrophoneOn' in extraInfo) {\n                _onRemoteMicStateUpdate(stream.user.userID, extraInfo.isMicrophoneOn)\n            }\n        } catch (error) {\n            zlogerror('roomStreamExtraInfoUpdate ERROR: ', error)\n        }\n    })\n  });\n  ZegoExpressEngine.instance().on('IMRecvCustomCommand', (roomID, fromUser, command) => {\n    zloginfo('IMRecvCustomCommand', roomID, fromUser, command);\n    _onIMCustomCommandReceived(roomID, fromUser, command);\n  });\n}\nfunction _unregisterEngineCallback() {\n  zloginfo('Unregister callback from ZegoExpressEngine...');\n  ZegoExpressEngine.instance().off('roomUserUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStreamUpdate', undefined);\n  ZegoExpressEngine.instance().off('publisherQualityUpdate', undefined);\n  ZegoExpressEngine.instance().off('playerQualityUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteCameraStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteMicStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('playerStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteSoundLevelUpdate', undefined);\n  ZegoExpressEngine.instance().off('capturedSoundLevelUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStateChanged', undefined);\n  ZegoExpressEngine.instance().off('audioRouteChange', undefined);\n  ZegoExpressEngine.instance().off('IMRecvBroadcastMessage', undefined);\n  ZegoExpressEngine.instance().off('roomExtraInfoUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStreamExtraInfoUpdate', undefined);\n  ZegoExpressEngine.instance().off('IMRecvCustomCommand', undefined);\n}\nfunction _notifyUserCountOrPropertyChanged(type: number) {\n  const msg = [\n    '',\n    'user add',\n    'user delete',\n    'mic update',\n    'camera update',\n    'attributes update',\n  ];\n  const userList = Object.values(_coreUserMap)\n    .sort((user1: any, user2: any) => {\n      return user2.joinTime - user1.joinTime;\n    })\n    .map((user) => _createPublicUser(user));\n  zloginfo(`_notifyUserCountOrPropertyChanged ${msg[type]}`, userList);\n  Object.keys(_onUserCountOrPropertyChangedCallbackMap).forEach(\n    (callbackID) => {\n      if (_onUserCountOrPropertyChangedCallbackMap[callbackID]) {\n        _onUserCountOrPropertyChangedCallbackMap[callbackID](\n          JSON.parse(JSON.stringify(userList))\n        );\n      }\n    }\n  );\n}\n\n// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Stream Handling <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\nfunction _getUserIDByStreamID(streamID: string) {\n  // StreamID format: roomid_userid_main\n  for (const userID in _coreUserMap) {\n    if (_coreUserMap[userID].streamID == streamID) {\n      return userID;\n    }\n  }\n  return '';\n}\nfunction _getPublishStreamID() {\n  return _currentRoomID + '_' + _localCoreUser.userID + '_main';\n}\nfunction _getStreamIDByUserID(userID: string) {\n  return _currentRoomID + '_' + userID + '_main';\n}\nfunction _tryStartPublishStream() {\n  if (_localCoreUser.isMicDeviceOn || _localCoreUser.isCameraDeviceOn) {\n    zloginfo(\n      '_tryStartPublishStream',\n      _localCoreUser.isMicDeviceOn,\n      _localCoreUser.isCameraDeviceOn,\n      _localCoreUser.streamID\n    );\n    if (!_localCoreUser.streamID) {\n      return;\n    }\n    ZegoExpressEngine.instance()\n      .startPublishingStream(_localCoreUser.streamID)\n      .then(() => {\n        zloginfo('Notify local user audioVideoAvailable start', _localCoreUser.streamID + '', JSON.parse(JSON.stringify(_streamCoreUserMap)));\n        // if (_localCoreUser.streamID in _streamCoreUserMap) {\n          _streamCoreUserMap[_localCoreUser.streamID] = _localCoreUser;\n\n          zloginfo('Notify local user audioVideoAvailable end', _localCoreUser);\n          Object.keys(_onAudioVideoAvailableCallbackMap).forEach(\n            (callbackID) => {\n              if (_onAudioVideoAvailableCallbackMap[callbackID]) {\n                _onAudioVideoAvailableCallbackMap[callbackID]([_localCoreUser]);\n              }\n            }\n          );\n        // }\n      });\n    zloginfo('ZegoExpressEngine startPreview:', _localCoreUser);\n    if (_localCoreUser.viewID > 0) {\n      ZegoExpressEngine.instance()\n        .startPreview({\n          reactTag: _localCoreUser.viewID,\n          viewMode: _localCoreUser.fillMode,\n          backgroundColor: 0,\n        })\n        .catch((error) => {\n          zlogerror(error);\n        });\n    }\n  }\n}\nfunction _tryStopPublishStream(force = false) {\n  if (!_localCoreUser.isMicDeviceOn && !_localCoreUser.isCameraDeviceOn) {\n    zloginfo('stopPublishStream');\n    ZegoExpressEngine.instance().stopPublishingStream();\n    ZegoExpressEngine.instance().stopPreview();\n    if (_localCoreUser.streamID in _streamCoreUserMap) {\n      delete _streamCoreUserMap[_localCoreUser.streamID];\n\n      Object.keys(_onAudioVideoUnavailableCallbackMap).forEach((callbackID) => {\n        if (_onAudioVideoUnavailableCallbackMap[callbackID]) {\n          _onAudioVideoUnavailableCallbackMap[callbackID]([_localCoreUser]);\n        }\n      });\n    }\n  }\n}\nfunction _tryStartPlayStream(userID: string) {\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    zloginfo(\n      '########_tryStartPlayStream##############: ',\n      user,\n      user.fillMode,\n      _audioVideoResourceMode,\n    );\n    if (user.streamID !== '') {\n      if (user.viewID > 0) {\n        ZegoExpressEngine.instance().startPlayingStream(user.streamID, {\n          reactTag: user.viewID,\n          viewMode: user.fillMode,\n          backgroundColor: 0,\n        }, {\n          resourceMode: _audioVideoResourceMode,\n        });\n      } else {\n        ZegoExpressEngine.instance().startPlayingStream(user.streamID, undefined, {\n          resourceMode: _audioVideoResourceMode,\n        });\n      }\n    }\n  }\n}\nfunction _tryStopPlayStream(userID: string, force = false) {\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    if (force || (!user.isMicDeviceOn && !user.isCameraDeviceOn)) {\n      ZegoExpressEngine.instance().stopPlayingStream(user.streamID);\n    }\n  }\n}\nfunction _notifyUserInfoUpdate(userInfo: any) {\n  Object.keys(_onUserInfoUpdateCallbackMap).forEach((callbackID) => {\n    if (_onUserInfoUpdateCallbackMap[callbackID]) {\n      _onUserInfoUpdateCallbackMap[callbackID](userInfo);\n    }\n  });\n}\nfunction _notifySoundLevelUpdate(userID: string, soundLevel: number) {\n  Object.keys(_onSoundLevelUpdateCallbackMap).forEach((callbackID) => {\n    if (_onSoundLevelUpdateCallbackMap[callbackID]) {\n      _onSoundLevelUpdateCallbackMap[callbackID](userID, soundLevel);\n    }\n  });\n}\nfunction _notifyRoomPropertyUpdate(key: string, oldValue: any, value: any, type: number) {\n  Object.keys(_onRoomPropertyUpdatedCallbackMap).forEach((callbackID) => {\n    if (_onRoomPropertyUpdatedCallbackMap[callbackID]) {\n      _onRoomPropertyUpdatedCallbackMap[callbackID](key, oldValue, value, type);\n    }\n  });\n}\nfunction _notifyRoomPropertiesFullUpdate(keys: string[], oldRoomProperties: any, roomProperties: any, type: number) {\n  Object.keys(_onRoomPropertiesFullUpdatedCallbackMap).forEach((callbackID) => {\n    if (_onRoomPropertiesFullUpdatedCallbackMap[callbackID]) {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID](keys, oldRoomProperties, roomProperties, type);\n    }\n  });\n}\nfunction _notifyMeRemovedFromRoom() {\n  Object.keys(_onMeRemovedFromRoomCallbackMap).forEach((callbackID) => {\n    if (_onMeRemovedFromRoomCallbackMap[callbackID]) {\n      _onMeRemovedFromRoomCallbackMap[callbackID]();\n    }\n  });\n}\nconst _isEngineCreated = () => {\n  try {\n    return ZegoExpressEngine.instance() != undefined;\n  } catch (error) {\n    return false;\n  }\n}\n\nexport default {\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Internal <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  isRoomConnected() {\n    return _isRoomConnected;\n  },\n  setAudioVideoResourceMode(audioVideoResourceMode: any) {\n    zloginfo('setAudioVideoResourceMode', audioVideoResourceMode);\n    _audioVideoResourceMode = audioVideoResourceMode || ZegoAudioVideoResourceMode.Default;\n  },\n  updateRenderingProperty(userID: string, viewID: number, fillMode: string) {\n    zloginfo(\n      'updateRenderingProperty: ',\n      userID,\n      viewID,\n      fillMode,\n      '<<<<<<<<<<<<<<<<<<<<<<<<<<'\n    );\n    if (userID === undefined) {\n      zlogwarning(\n        'updateRenderingProperty: ignore undifine useid. Use empty string for local user.'\n      );\n      return;\n    }\n    if (userID === '') {\n      userID = _localCoreUser.userID;\n    }\n    if (userID in _coreUserMap) {\n      _coreUserMap[userID].viewID = viewID;\n      _coreUserMap[userID].fillMode = fillMode;\n      _notifyUserInfoUpdate(_coreUserMap[userID]);\n\n      if (_localCoreUser.userID == userID) {\n        _localCoreUser.viewID = viewID;\n        _localCoreUser.fillMode = fillMode;\n        if (viewID > 0) {\n          _tryStartPublishStream();\n        } else {\n          _tryStopPublishStream();\n        }\n      } else {\n        // Check if stream is ready to play for remote user\n        if (viewID > 0) {\n          _tryStartPlayStream(userID);\n        }\n      }\n    }\n  },\n  onUserInfoUpdate(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserInfoUpdateCallbackMap) {\n        zloginfo(\n          '[onUserInfoUpdate] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserInfoUpdateCallbackMap[callbackID];\n      }\n    } else {\n      _onUserInfoUpdateCallbackMap[callbackID] = callback;\n    }\n  },\n  onSoundLevelUpdate(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onSoundLevelUpdateCallbackMap) {\n        zloginfo(\n          '[onSoundLevelUpdate] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onSoundLevelUpdateCallbackMap[callbackID];\n      }\n    } else {\n      _onSoundLevelUpdateCallbackMap[callbackID] = callback;\n    }\n  },\n  onSDKConnected(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onSDKConnectedCallbackMap) {\n        zloginfo(\n          '[onSDKConnected] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onSDKConnectedCallbackMap[callbackID];\n      }\n    } else {\n      _onSDKConnectedCallbackMap[callbackID] = callback;\n    }\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> SDK <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  connectSDK(appID: number, appSign: string, userInfo: any) {\n    // Solve the problem of repeated initialization\n    if (_isEngineCreated()) {\n      zloginfo('Create ZegoExpressEngine succeed already!');\n\n      \n      _unregisterEngineCallback();\n      _registerEngineCallback();\n\n      Object.keys(_onSDKConnectedCallbackMap).forEach((callbackID) => {\n        // TODO cause  WARN  Possible Unhandled Promise Rejection (id: 56)\n        if (_onSDKConnectedCallbackMap[callbackID]) {\n          _onSDKConnectedCallbackMap[callbackID]();\n        }\n      });\n\n      return Promise.resolve();\n    }\n    return new Promise<void>((resolve, reject) => {\n      // set advancedConfig to monitor remote user's device changed\n      ZegoExpressEngine.setEngineConfig({\n        advancedConfig: {\n          // @ts-ignore\n          notify_remote_device_unknown_status: 'true',\n          notify_remote_device_init_status: 'true',\n        },\n      });\n      const engineProfile: ZegoEngineProfile = {\n        appID: appID,\n        appSign: appSign,\n        scenario: 0,\n      };\n      ZegoExpressEngine.createEngineWithProfile(engineProfile)\n        .then((engine) => {\n          zloginfo('Create ZegoExpressEngine succeed!');\n          _appInfo.appID = appID;\n          _appInfo.appSign = appSign;\n          _unregisterEngineCallback();\n          _registerEngineCallback();\n\n          _setLocalUserInfo(userInfo);\n\n          Object.keys(_onSDKConnectedCallbackMap).forEach((callbackID) => {\n            // TODO cause  WARN  Possible Unhandled Promise Rejection (id: 56)\n            if (_onSDKConnectedCallbackMap[callbackID]) {\n              _onSDKConnectedCallbackMap[callbackID]();\n            }\n          });\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Create ZegoExpressEngine Failed: ', error);\n          reject(error);\n        });\n    });\n  },\n  disconnectSDK() {\n    return new Promise<void>((resolve, reject) => {\n      if (ZegoExpressEngine.instance()) {\n        ZegoExpressEngine.destroyEngine()\n          .then(() => {\n            zloginfo('Destroy ZegoExpressEngine finished!');\n            resolve();\n          })\n          .catch((error) => {\n            zlogerror('Destroy ZegoExpressEngine failed!', error);\n            reject(error);\n          })\n          .finally(() => {\n            _resetData();\n          });\n      } else {\n        resolve();\n      }\n    });\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Audio Video <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  useFrontFacingCamera(isFrontFacing: boolean) {\n    zloginfo('Use front facing camera: ', isFrontFacing);\n    _usingFrontFacingCamera = isFrontFacing;\n    return ZegoExpressEngine.instance().useFrontCamera(isFrontFacing, 0);\n  },\n  isUsingFrontFacingCamera() {\n    return _usingFrontFacingCamera;\n  },\n  isMicDeviceOn(userID: string) {\n    if (!userID) {\n      return _localCoreUser.isMicDeviceOn;\n    } else if (userID in _coreUserMap) {\n      return _coreUserMap[userID].isMicDeviceOn;\n    } else {\n      zlogwarning(\n        'Can not check mic device is on for user[',\n        userID,\n        '], because no record!'\n      );\n      return true;\n    }\n  },\n  isCameraDeviceOn(userID: string) {\n    if (!userID) {\n      return _localCoreUser.isCameraDeviceOn;\n    } else if (userID in _coreUserMap) {\n      return _coreUserMap[userID].isCameraDeviceOn;\n    } else {\n      zlogwarning(\n        'No record for user: ',\n        userID,\n        '. Can not check camera device is on.'\n      );\n      return true;\n    }\n  },\n  enableSpeaker(enable: boolean) {\n    // TODO\n    return new Promise<void>((resolve, reject) => {\n      if (!_isRoomConnected) {\n        zlogerror('You are not connect to any room.');\n        reject();\n      } else {\n        ZegoExpressEngine.instance().muteSpeaker(!enable);\n        resolve();\n      }\n    });\n  },\n  audioOutputDeviceType() {\n    return _audioOutputType;\n  },\n  turnMicDeviceOn(userID: string, on: boolean) {\n    return _turnMicDeviceOn(userID, on);\n  },\n  turnCameraDeviceOn(userID: string, on: boolean) {\n    return _turnCameraDeviceOn(userID, on);\n  },\n  onMicDeviceOn(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMicDeviceOnCallbackMap) {\n        zloginfo(\n          '[onMicDeviceOn] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMicDeviceOnCallbackMap[callbackID];\n      }\n    } else {\n      _onMicDeviceOnCallbackMap[callbackID] = callback;\n    }\n  },\n  onCameraDeviceOn(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onCameraDeviceOnCallbackMap) {\n        zloginfo(\n          '[onCameraDeviceOn] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onCameraDeviceOnCallbackMap[callbackID];\n      }\n    } else {\n      _onCameraDeviceOnCallbackMap[callbackID] = callback;\n    }\n  },\n  setAudioOutputToSpeaker(isSpeaker: boolean) {\n    ZegoExpressEngine.instance().setAudioRouteToSpeaker(isSpeaker);\n  },\n  onAudioOutputDeviceTypeChange(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioOutputDeviceTypeChangeCallbackMap) {\n        zloginfo(\n          '[onAudioOutputDeviceTypeChange] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioOutputDeviceTypeChangeCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioOutputDeviceTypeChangeCallbackMap[callbackID] = callback;\n    }\n  },\n  setAudioConfig(config: any) {\n    // TODO\n  },\n  setVideoConfig(config: any) {\n    // TODO\n  },\n  onAudioVideoAvailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoAvailableCallbackMap) {\n        zloginfo(\n          '[onAudioVideoAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoAvailableCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoAvailableCallbackMap[callbackID] = callback;\n    }\n  },\n  onAudioVideoUnavailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoUnavailableCallbackMap) {\n        zloginfo(\n          '[onAudioVideoUnavailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoUnavailableCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoUnavailableCallbackMap[callbackID] = callback;\n    }\n  },\n  startPlayingAllAudioVideo() {\n    ZegoExpressEngine.instance().muteAllPlayStreamAudio(false);\n    ZegoExpressEngine.instance().muteAllPlayStreamVideo(false);\n  },\n  stopPlayingAllAudioVideo() {\n    ZegoExpressEngine.instance().muteAllPlayStreamAudio(true);\n    ZegoExpressEngine.instance().muteAllPlayStreamVideo(true);\n  },\n  onTurnOnYourCameraRequest(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onTurnOnYourCameraRequestCallbackMap) {\n        zloginfo(\n          '[onTurnOnYourCameraRequest] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onTurnOnYourCameraRequestCallbackMap[callbackID];\n      }\n    } else {\n      _onTurnOnYourCameraRequestCallbackMap[callbackID] = callback;\n    }\n  },\n  onTurnOnYourMicrophoneRequest(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onTurnOnYourMicrophoneRequestCallbackMap) {\n        zloginfo(\n          '[onTurnOnYourMicrophoneRequest] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onTurnOnYourMicrophoneRequestCallbackMap[callbackID];\n      }\n    } else {\n      _onTurnOnYourMicrophoneRequestCallbackMap[callbackID] = callback;\n    }\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Room <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  joinRoom(roomID: string, token: string, markAsLargeRoom = false) {\n    // Solve the problem of repeated join\n    if (_isRoomConnected && _currentRoomID === roomID) {\n      zloginfo('Join room success already');\n      return Promise.resolve();\n    }\n    return new Promise<void>((resolve, reject) => {\n      const user = {\n        userID: _localCoreUser.userID,\n        userName: _localCoreUser.userName,\n      };\n      const config = { isUserStatusNotify: true } as ZegoRoomConfig;\n      token && (config.token = token);\n      _currentRoomID = roomID;\n      ZegoExpressEngine.instance()\n        .loginRoom(roomID, user, config)\n        .then(() => {\n          zloginfo('Join room success.', user);\n          _roomMemberCount = 1\n          _markAsLargeRoom = markAsLargeRoom;\n          ZegoExpressEngine.instance().startSoundLevelMonitor();\n\n          _localCoreUser.streamID = _getPublishStreamID();\n          _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n          _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userAdd);\n\n          _tryStartPublishStream()\n\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Join room falied: ', error);\n          _currentRoomID = '';\n          reject(error);\n        });\n    });\n  },\n  leaveRoom() {\n    return _leaveRoom();\n  },\n  onRoomStateChanged(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomStateChangedCallbackMap) {\n        zloginfo(\n          '[onRoomStateChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomStateChangedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomStateChangedCallbackMap[callbackID] = callback;\n    }\n  },\n  onRequireNewToken(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRequireNewTokenCallbackMap) {\n        zloginfo(\n          '[onRequireNewToken] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRequireNewTokenCallbackMap[callbackID];\n      }\n    } else {\n      _onRequireNewTokenCallbackMap[callbackID] = callback;\n    }\n  },\n  setRoomProperty(key: string, value: any) {\n    if (!_isRoomConnected) {\n      zlogerror('You need to join the room before using this interface!');\n      return;\n    }\n    if (_roomProperties[key] === value) {\n      return;\n    }\n    const oldValue = _roomProperties[key];\n    const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n    _roomProperties[key] = value;\n    const extraInfo = JSON.stringify(_roomProperties);\n    zloginfo('[updateRoomProperties]Set start', extraInfo);\n    return new Promise<void>((resolve, reject) => {\n      ZegoExpressEngine.instance().setRoomExtraInfo(_currentRoomID, 'extra_info', extraInfo).then(({ errorCode }) => {\n        if (errorCode === 0) {\n          zloginfo('[updateRoomProperties]Set success');\n          resolve();\n          // Notify\n          _notifyRoomPropertyUpdate(key, oldValue, value, ZegoRoomPropertyUpdateType.set);\n          _notifyRoomPropertiesFullUpdate([key], oldRoomProperties, JSON.parse(extraInfo), ZegoRoomPropertyUpdateType.set);\n        } else {\n          // Restore\n          _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n          zlogwarning('[setRoomProperty]Set failed, errorCode: ', errorCode);\n          reject({ code: errorCode });\n        }\n      }).catch((error) => {\n        // Restore\n        _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n        zlogerror('[setRoomProperty]Set error', error);\n        reject(error);\n      });\n    });\n  },\n  updateRoomProperties(newRoomProperties: any) {\n    if (!_isRoomConnected) {\n      zlogerror('You need to join the room before using this interface!');\n      return Promise.reject();\n    }\n    const updateKeys: string[] = [];\n    const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n    Object.keys(newRoomProperties).forEach((key) => {\n      if (oldRoomProperties[key] !== newRoomProperties[key]) {\n        updateKeys.push(key);\n        _roomProperties[key] = newRoomProperties[key];\n      }\n    })\n    const extraInfo = JSON.stringify(_roomProperties);\n    zloginfo('[updateRoomProperties]Update start', extraInfo);\n    return new Promise<void>((resolve, reject) => {\n      ZegoExpressEngine.instance().setRoomExtraInfo(_currentRoomID, 'extra_info', extraInfo).then(({ errorCode }) => {\n        if (errorCode === 0) {\n          zloginfo('[updateRoomProperties]Update success');\n          resolve();\n          // Notify\n          updateKeys.forEach((updateKey) => {\n            const oldValue = oldRoomProperties[updateKey];\n            const value = newRoomProperties[updateKey];\n            _notifyRoomPropertyUpdate(updateKey, oldValue, value, ZegoRoomPropertyUpdateType.update);\n          })\n          updateKeys.length && _notifyRoomPropertiesFullUpdate(updateKeys, oldRoomProperties, JSON.parse(extraInfo), ZegoRoomPropertyUpdateType.update);\n        } else {\n          // Restore\n          _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n          zlogwarning('[updateRoomProperties]Update failed, errorCode: ', errorCode);\n          reject({ code: errorCode });\n        }\n      }).catch((error) => {\n        // Restore\n        _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n        zlogerror('[updateRoomProperties]Update error', error);\n        reject(error);\n      });\n    });\n  },\n  getRoomProperties() {\n    return _roomProperties;\n  },\n  onRoomPropertyUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertyUpdatedCallbackMap) {\n        zloginfo(\n          '[onRoomPropertyUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertyUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertyUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  onRoomPropertiesFullUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertiesFullUpdatedCallbackMap) {\n        zloginfo(\n          '[onRoomPropertiesFullUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertiesFullUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  sendInRoomCommand(command: string, toUserIDs: string[] = []) {\n    const toUserList = toUserIDs.map((userID) => {\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      return {\n        userID,\n        userName,\n      };\n    });\n    return _sendInRoomCommand(command, toUserList);\n  },\n  onInRoomCommandReceived(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomCommandReceivedCallbackMap) {\n        zloginfo(\n          '[onInRoomCommandReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomCommandReceivedCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomCommandReceivedCallbackMap[callbackID] = callback;\n    }\n  },\n  onMeRemovedFromRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMeRemovedFromRoomCallbackMap) {\n        zloginfo(\n          '[onMeRemovedFromRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMeRemovedFromRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onMeRemovedFromRoomCallbackMap[callbackID] = callback;\n    }\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> User <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  connectUser(userID: string, userName: string) {\n    _setLocalUserInfo({ userID: userID, userName: userName });\n    // TODO ZIM login\n  },\n  disconnectUser() {\n    delete _coreUserMap[_localCoreUser.userID];\n    _localCoreUser = _createCoreUser('', '', '', {});\n    // TODO ZIM logout\n  },\n  getLocalUserInfo() {\n    return _localCoreUser;\n  },\n  getUser(userID: string) {\n    return _coreUserMap[userID];\n  },\n  getAllUsers() {\n    const users = Object.values(_coreUserMap);\n    users.sort((a: any, b: any) => {\n      return a.joinTime - b.joinTime;\n    });\n    var publicUsers: any[] = [];\n    users.forEach((user) => {\n      publicUsers.push(_createPublicUser(user));\n    });\n    return publicUsers;\n  },\n  onUserJoin(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserJoinCallbackMap) {\n        zloginfo(\n          '[onUserJoin] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserJoinCallbackMap[callbackID];\n      }\n    } else {\n      _onUserJoinCallbackMap[callbackID] = callback;\n    }\n  },\n  onUserLeave(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserLeaveCallbackMap) {\n        zloginfo(\n          '[onUserLeave] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserLeaveCallbackMap[callbackID];\n      }\n    } else {\n      _onUserLeaveCallbackMap[callbackID] = callback;\n    }\n  },\n  onOnlySelfInRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onOnlySelfInRoomCallbackMap) {\n        zloginfo(\n          '[onOnlySelfInRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onOnlySelfInRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onOnlySelfInRoomCallbackMap[callbackID] = callback;\n    }\n  },\n  onUserCountOrPropertyChanged(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserCountOrPropertyChangedCallbackMap) {\n        zloginfo(\n          '[onUserCountOrPropertyChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserCountOrPropertyChangedCallbackMap[callbackID];\n      }\n    } else {\n      _onUserCountOrPropertyChangedCallbackMap[callbackID] = callback;\n    }\n  },\n  removeUserFromRoom(userIDs: string[] = []) {\n    const command = JSON.stringify({ zego_remove_user: userIDs });\n    const toUserList = (_isLargeRoom || _markAsLargeRoom) ? [] : userIDs.map((userID) => {\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      return {\n        userID,\n        userName,\n      };\n    });\n    return _sendInRoomCommand(command, toUserList);\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Message <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  getInRoomMessages() {\n    return _inRoomMessageList;\n  },\n  sendInRoomMessage(message: string) {\n    return new Promise((resolve, reject) => {\n      ZegoExpressEngine.instance()\n        .sendBroadcastMessage(_currentRoomID, message)\n        .then((result) => {\n          zloginfo('SendInRoomMessage finished.', result);\n          const { errorCode, messageID } = result;\n          if (errorCode > 0) {\n            reject(errorCode);\n          } else {\n            const inRoomMessage = {\n              message: message,\n              messageID: messageID,\n              sendTime: Date.now(),\n              sender: _createPublicUser(_localCoreUser),\n            };\n            _inRoomMessageList.push(inRoomMessage);\n\n            Object.keys(_onInRoomMessageSentCallbackMap).forEach(\n              (callbackID) => {\n                // callback may remove from map during room state chaging\n                if (callbackID in _onInRoomMessageSentCallbackMap) {\n                  if (_onInRoomMessageSentCallbackMap[callbackID]) {\n                    _onInRoomMessageSentCallbackMap[callbackID](\n                      errorCode,\n                      messageID\n                    );\n                  }\n                }\n              }\n            );\n\n            resolve(result);\n          }\n        })\n        .catch((error) => {\n          zlogerror('SendInRoomMessage falied: ', error);\n          reject(error);\n        });\n    });\n  },\n  onInRoomMessageReceived(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomMessageReceivedCallbackMap) {\n        zloginfo(\n          '[onInRoomMessageReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomMessageReceivedCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomMessageReceivedCallbackMap[callbackID] = callback;\n    }\n  },\n  onInRoomMessageSent(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomMessageSentCallbackMap) {\n        zloginfo(\n          '[onInRoomMessageSent] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomMessageSentCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomMessageSentCallbackMap[callbackID] = callback;\n    }\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Live audio room <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  notifyUserCountOrPropertyChanged(type: number) {\n    _notifyUserCountOrPropertyChanged(type);\n  },\n  notifyUserInfoUpdate(userID: string) {\n    // Update avatar properties\n    if ( _coreUserMap[userID] && _coreUserMap[userID].inRoomAttributes) {\n      _coreUserMap[userID].avatar = _coreUserMap[userID].inRoomAttributes.avatar;\n    }\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Force update component <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  forceSortMemberList() {\n    zloginfo('[forceSortMemberList callback]');\n    const userList = Object.values(_coreUserMap)\n      .sort((user1: any, user2: any) => {\n        return user2.joinTime - user1.joinTime;\n      })\n      .map((user) => _createPublicUser(user));\n    Object.keys(_onMemberListForceSortCallbackMap).forEach((callbackID) => {\n      if (_onMemberListForceSortCallbackMap[callbackID]) {\n        _onMemberListForceSortCallbackMap[callbackID](userList);\n      }\n    });\n  },\n  onMemberListForceSort(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMemberListForceSortCallbackMap) {\n        zloginfo(\n          '[onMemberListForceSort] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMemberListForceSortCallbackMap[callbackID];\n      }\n    } else {\n      _onMemberListForceSortCallbackMap[callbackID] = callback;\n    }\n  },\n  forceSortAudioVideoList() {\n    zloginfo('[forceSortAudioVideoList callback]');\n    Object.keys(_onAudioVideoListForceSortCallbackMap).forEach((callbackID) => {\n      if (_onAudioVideoListForceSortCallbackMap[callbackID]) {\n        _onAudioVideoListForceSortCallbackMap[callbackID]();\n      }\n    });\n  },\n  onAudioVideoListForceSort(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoListForceSortCallbackMap) {\n        zloginfo(\n          '[onAudioVideoListForceSort] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoListForceSortCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoListForceSortCallbackMap[callbackID] = callback;\n    }\n  },\n  forceRenderVideoView() {\n    zloginfo('[forceRenderVideoView callback]');\n    Object.keys(_onVideoViewForceRenderCallbackMap).forEach((callbackID) => {\n      if (_onVideoViewForceRenderCallbackMap[callbackID]) {\n        _onVideoViewForceRenderCallbackMap[callbackID]();\n      }\n    });\n  },\n  onVideoViewForceRender(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onVideoViewForceRenderCallbackMap) {\n        zloginfo(\n          '[onVideoViewForceRender] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onVideoViewForceRenderCallbackMap[callbackID];\n      }\n    } else {\n      _onVideoViewForceRenderCallbackMap[callbackID] = callback;\n    }\n  },\n  \n  onError(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n        if (callbackID in _onErrorCallbackMap) {\n            zloginfo(\n                '[onError] Remove callback for: [',\n                callbackID,\n                '] because callback is not a valid function!'\n              );\n            delete _onErrorCallbackMap[callbackID];\n        }\n    } else {\n        _onErrorCallbackMap[callbackID] = callback;\n    }\n  },\n\n  notifyErrorUpdate(method: string, error: number, message: string) {\n    Object.keys(_onErrorCallbackMap).forEach((callbackID) => {\n      if (_onErrorCallbackMap[callbackID]) {\n          _onErrorCallbackMap[callbackID](method, error, message);\n      }\n    });\n  }\n};\n"],"mappings":"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"}
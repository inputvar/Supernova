{"version":3,"names":["_logger","require","_defines","_plugins","Map","ZegoUIKitCorePlugin","installPlugins","plugins","Array","zlogerror","forEach","plugin","ZIMConnectionState","get","zloginfo","set","ZPNsPushSourceType","getInstance","type","getPluginType","Object","values","ZegoUIKitPluginType","includes","getZIMPlugin","getZPNsPlugin","getPlugin","signaling","_default","exports","default"],"sources":["ZegoUIKitCorePlugin.ts"],"sourcesContent":["import { zloginfo, zlogerror } from '../../utils/logger';\nimport { ZegoUIKitPluginType } from './defines';\n\nconst _plugins = new Map(); // type -> plugin\nconst ZegoUIKitCorePlugin = {\n  installPlugins: (plugins: any[]) => {\n    if (!plugins || !(plugins instanceof Array)) {\n      zlogerror('[ZegoUIKitCorePlugin][installPlugins]The parameter passed in was incorrect');\n      return;\n    }\n    plugins.forEach((plugin) => {\n      if (plugin.ZIMConnectionState) {\n        if (_plugins.get('ZIM')) {\n          zloginfo(\n            '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugin: ZIM'\n          );\n        } else {\n          _plugins.set('ZIM', plugin);\n          zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ZIM');\n        }\n      } else if (plugin.ZPNsPushSourceType) {\n        if (_plugins.get('ZPNs')) {\n          zloginfo(\n            '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugin: ZPNs'\n          );\n        } else {\n          _plugins.set('ZPNs', plugin);\n          zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ZPNs');\n        }\n      } else if (typeof plugin.getInstance === 'function') {\n        // Compatible with the original usage\n        const type = plugin.getInstance().getPluginType\n          ? plugin.getInstance().getPluginType()\n          : null;\n        if (Object.values(ZegoUIKitPluginType).includes(type)) {\n          if (_plugins.get(type)) {\n            zloginfo(\n              '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugins: ', type\n            );\n          } else {\n            _plugins.set(type, plugin);\n            zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ', type);\n          }\n        }\n      }\n    });\n  },\n  getZIMPlugin: () => {\n    return _plugins.get('ZIM');\n  },\n  getZPNsPlugin: () => {\n    return _plugins.get('ZPNs');\n  },\n  getPlugin: (type: number) => {\n    if (type === ZegoUIKitPluginType.signaling) {\n      zloginfo('[ZegoUIKitCorePlugin][getPlugin] type: ', type);\n      return _plugins.get(type) || ZegoUIKitCorePlugin.getZIMPlugin();\n    }\n    return _plugins.get(type);\n  },\n};\nexport default ZegoUIKitCorePlugin;\nexport { ZegoUIKitPluginType };\n"],"mappings":";;;;;;;;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAEA,MAAME,QAAQ,GAAG,IAAIC,GAAG,CAAC,CAAC,CAAC,CAAC;AAC5B,MAAMC,mBAAmB,GAAG;EAC1BC,cAAc,EAAGC,OAAc,IAAK;IAClC,IAAI,CAACA,OAAO,IAAI,EAAEA,OAAO,YAAYC,KAAK,CAAC,EAAE;MAC3C,IAAAC,iBAAS,EAAC,4EAA4E,CAAC;MACvF;IACF;IACAF,OAAO,CAACG,OAAO,CAAEC,MAAM,IAAK;MAC1B,IAAIA,MAAM,CAACC,kBAAkB,EAAE;QAC7B,IAAIT,QAAQ,CAACU,GAAG,CAAC,KAAK,CAAC,EAAE;UACvB,IAAAC,gBAAQ,EACN,4GACF,CAAC;QACH,CAAC,MAAM;UACLX,QAAQ,CAACY,GAAG,CAAC,KAAK,EAAEJ,MAAM,CAAC;UAC3B,IAAAG,gBAAQ,EAAC,0EAA0E,CAAC;QACtF;MACF,CAAC,MAAM,IAAIH,MAAM,CAACK,kBAAkB,EAAE;QACpC,IAAIb,QAAQ,CAACU,GAAG,CAAC,MAAM,CAAC,EAAE;UACxB,IAAAC,gBAAQ,EACN,6GACF,CAAC;QACH,CAAC,MAAM;UACLX,QAAQ,CAACY,GAAG,CAAC,MAAM,EAAEJ,MAAM,CAAC;UAC5B,IAAAG,gBAAQ,EAAC,2EAA2E,CAAC;QACvF;MACF,CAAC,MAAM,IAAI,OAAOH,MAAM,CAACM,WAAW,KAAK,UAAU,EAAE;QACnD;QACA,MAAMC,IAAI,GAAGP,MAAM,CAACM,WAAW,CAAC,CAAC,CAACE,aAAa,GAC3CR,MAAM,CAACM,WAAW,CAAC,CAAC,CAACE,aAAa,CAAC,CAAC,GACpC,IAAI;QACR,IAAIC,MAAM,CAACC,MAAM,CAACC,4BAAmB,CAAC,CAACC,QAAQ,CAACL,IAAI,CAAC,EAAE;UACrD,IAAIf,QAAQ,CAACU,GAAG,CAACK,IAAI,CAAC,EAAE;YACtB,IAAAJ,gBAAQ,EACN,0GAA0G,EAAEI,IAC9G,CAAC;UACH,CAAC,MAAM;YACLf,QAAQ,CAACY,GAAG,CAACG,IAAI,EAAEP,MAAM,CAAC;YAC1B,IAAAG,gBAAQ,EAAC,uEAAuE,EAAEI,IAAI,CAAC;UACzF;QACF;MACF;IACF,CAAC,CAAC;EACJ,CAAC;EACDM,YAAY,EAAEA,CAAA,KAAM;IAClB,OAAOrB,QAAQ,CAACU,GAAG,CAAC,KAAK,CAAC;EAC5B,CAAC;EACDY,aAAa,EAAEA,CAAA,KAAM;IACnB,OAAOtB,QAAQ,CAACU,GAAG,CAAC,MAAM,CAAC;EAC7B,CAAC;EACDa,SAAS,EAAGR,IAAY,IAAK;IAC3B,IAAIA,IAAI,KAAKI,4BAAmB,CAACK,SAAS,EAAE;MAC1C,IAAAb,gBAAQ,EAAC,yCAAyC,EAAEI,IAAI,CAAC;MACzD,OAAOf,QAAQ,CAACU,GAAG,CAACK,IAAI,CAAC,IAAIb,mBAAmB,CAACmB,YAAY,CAAC,CAAC;IACjE;IACA,OAAOrB,QAAQ,CAACU,GAAG,CAACK,IAAI,CAAC;EAC3B;AACF,CAAC;AAAC,IAAAU,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACazB,mBAAmB"}
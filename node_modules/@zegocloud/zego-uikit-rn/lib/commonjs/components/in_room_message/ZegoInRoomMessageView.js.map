{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_ZegoUIKitInternal","_interopRequireDefault","_reactDelegateComponent","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ZegoInRoomMessageView","props","itemBuilder","listRef","useRef","messageList","setMessageList","useState","refreshMessage","arr","ZegoUIKitInternal","getInRoomMessages","renderItem","_ref","item","createElement","View","style","styles","messageContainer","Text","nameLabel","sender","userName","messageLabel","message","to","useEffect","callbackID","String","Math","floor","random","onInRoomMessageReceived","onInRoomMessageSent","FlatList","showsVerticalScrollIndicator","ref","data","onContentSizeChange","length","current","scrollToEnd","StyleSheet","create","alignSelf","backgroundColor","borderRadius","flexDirection","justifyContent","alignItems","marginTop","paddingTop","paddingBottom","paddingRight","paddingLeft","color","fontSize","marginLeft"],"sources":["ZegoInRoomMessageView.tsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { FlatList, Text, StyleSheet, View } from 'react-native';\nimport ZegoUIKitInternal from '../internal/ZegoUIKitInternal';\nimport Delegate from 'react-delegate-component';\n\nexport default function ZegoInRoomMessageView(props: any) {\n  const { itemBuilder } = props;\n  const listRef = useRef(null);\n  const [messageList, setMessageList] = useState([]);\n\n  const refreshMessage = () => {\n    // Update list like this will cause rerender\n    setMessageList((arr) => [...ZegoUIKitInternal.getInRoomMessages()]);\n  };\n  const renderItem = ({ item }: any) => {\n    return (\n      !itemBuilder ? <View style={styles.messageContainer}>\n        <Text style={styles.nameLabel}>\n          {item.sender.userName}\n          <Text style={styles.messageLabel}> {item.message}</Text>\n        </Text>\n      </View> : <Delegate to={itemBuilder} props={{ message: item }} />\n    );\n  }\n\n  useEffect(() => {\n    refreshMessage();\n  }, []);\n  useEffect(() => {\n    const callbackID =\n      'ZegoInRoomMessageView' + String(Math.floor(Math.random() * 10000));\n    ZegoUIKitInternal.onInRoomMessageReceived(callbackID, () => {\n      refreshMessage();\n    });\n    ZegoUIKitInternal.onInRoomMessageSent(callbackID, () => {\n      refreshMessage();\n    });\n\n    return () => {\n      ZegoUIKitInternal.onInRoomMessageReceived(callbackID);\n      ZegoUIKitInternal.onInRoomMessageSent(callbackID);\n    };\n  }, []);\n  return (\n    <FlatList\n      showsVerticalScrollIndicator={false}\n      ref={listRef}\n      data={messageList}\n      // https://stackoverflow.com/questions/46304677/scrolltoend-after-update-data-for-flatlist\n      onContentSizeChange={() => {\n        if (messageList.length) {\n          listRef.current.scrollToEnd();\n        }\n      }}\n      renderItem={renderItem}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  messageContainer: {\n    alignSelf: 'flex-start',\n    backgroundColor: 'rgba(1, 7, 18, 0.3000)',\n    borderRadius: 13,\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'center',\n    marginTop: 4,\n    paddingTop: 5,\n    paddingBottom: 5,\n    paddingRight: 10,\n    paddingLeft: 10,\n  },\n  nameLabel: {\n    color: '#8BE7FF',\n    fontSize: 13,\n    // marginLeft: 10\n  },\n  messageLabel: {\n    color: 'white',\n    fontSize: 13,\n    marginLeft: 5,\n  },\n});\n"],"mappings":"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"}
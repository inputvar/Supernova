{"version":3,"names":["ZegoUIKit","ZegoUIKitPluginType","ZegoInvitationConnectionState","zloginfo","_appInfo","_localUser","_pluginConnectionState","ZIMKitPlugin","_install","plugins","installPlugins","forEach","plugin","ZIMKit","default","getModuleName","temp","ZegoPrebuiltPlugins","init","appID","appSign","userID","userName","callbackID","String","Math","floor","random","getPlugin","signaling","getSignalingPlugin","onConnectionStateChanged","state","login","then","Promise","resolve","joinRoom","roomID","reconnectIfDisconnected","disconnected","logout","uninit","getLocalUser","getAppInfo","getZIMKitPlugin"],"sources":["plugins.ts"],"sourcesContent":["import ZegoUIKit, {\n  ZegoUIKitPluginType,\n  ZegoInvitationConnectionState,\n} from '@zegocloud/zego-uikit-rn';\nimport { zloginfo } from '../utils/logger';\n\nconst _appInfo = {} as any;\nconst _localUser = {} as any;\nlet _pluginConnectionState: number;\nlet ZIMKitPlugin: any = null;\nconst _install = (plugins: any[]) => {\n  ZegoUIKit.installPlugins(plugins);\n  plugins.forEach(plugin => {\n    if (plugin.ZIMKit) {\n      zloginfo('[Plugins] install ZIMKit success.');\n      ZIMKitPlugin = plugin;\n    } else if (plugin.default && typeof plugin.default.getModuleName === 'function') {\n      const temp = plugin.default.getModuleName();\n      if (temp === 'ZIMKit') {\n        zloginfo('[Plugins] install ZIMKit success.');\n        ZIMKitPlugin = plugin;\n      }\n    }\n  })\n};\n\nconst ZegoPrebuiltPlugins = {\n  init: (appID: number, appSign: string, userID: string, userName: string, plugins: any[]) => {\n    const callbackID =\n      'ZegoPrebuiltPlugins' + String(Math.floor(Math.random() * 10000));\n    _install(plugins);\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKit.getSignalingPlugin().init(appID, appSign);\n      ZegoUIKit.getSignalingPlugin().onConnectionStateChanged(\n        callbackID,\n        ({ state }: any) => {\n          _pluginConnectionState = state;\n        }\n      );\n      _appInfo.appID = appID;\n      _appInfo.appSign = appSign;\n      _localUser.userID = userID;\n      _localUser.userName = userName;\n      return ZegoUIKit.getSignalingPlugin().login(userID, userName).then(() => {\n        zloginfo('[Plugins] login success.');\n        return true;\n      });\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n      return Promise.resolve(false);\n    }\n  },\n  joinRoom(roomID: string) {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      return ZegoUIKit.getSignalingPlugin().joinRoom(roomID).then(() => {\n        zloginfo('[Plugins] join room success.');\n        return true;\n      });\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n      return Promise.resolve(false);\n    }\n  },\n  reconnectIfDisconnected: () => {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      zloginfo(\n        '[Plugins] reconnectIfDisconnected',\n        _pluginConnectionState,\n        ZegoInvitationConnectionState.disconnected\n      );\n      if (_pluginConnectionState === ZegoInvitationConnectionState.disconnected) {\n        ZegoUIKit.getSignalingPlugin().logout().then(() => {\n          zloginfo('[Plugins] auto logout success.');\n          ZegoUIKit.getSignalingPlugin().login(\n            _localUser.userID,\n            _localUser.userName\n          ).then(() => {\n            zloginfo('[Plugins] auto reconnect success.');\n          });\n        });\n      }\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n    }\n  },\n  uninit: () => {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKit.getSignalingPlugin().logout();\n      ZegoUIKit.getSignalingPlugin().uninit();\n    }\n  },\n  getLocalUser: () => {\n    return _localUser;\n  },\n  getAppInfo: () => {\n    return _appInfo;\n  },\n  getZIMKitPlugin: () => {\n    return ZIMKitPlugin;\n  }\n};\n\nexport default ZegoPrebuiltPlugins;\n"],"mappings":"AAAA,OAAOA,SAAS,IACdC,mBAAmB,EACnBC,6BAA6B,QACxB,0BAA0B;AACjC,SAASC,QAAQ,QAAQ,iBAAiB;AAE1C,MAAMC,QAAQ,GAAG,CAAC,CAAQ;AAC1B,MAAMC,UAAU,GAAG,CAAC,CAAQ;AAC5B,IAAIC,sBAA8B;AAClC,IAAIC,YAAiB,GAAG,IAAI;AAC5B,MAAMC,QAAQ,GAAIC,OAAc,IAAK;EACnCT,SAAS,CAACU,cAAc,CAACD,OAAO,CAAC;EACjCA,OAAO,CAACE,OAAO,CAACC,MAAM,IAAI;IACxB,IAAIA,MAAM,CAACC,MAAM,EAAE;MACjBV,QAAQ,CAAC,mCAAmC,CAAC;MAC7CI,YAAY,GAAGK,MAAM;IACvB,CAAC,MAAM,IAAIA,MAAM,CAACE,OAAO,IAAI,OAAOF,MAAM,CAACE,OAAO,CAACC,aAAa,KAAK,UAAU,EAAE;MAC/E,MAAMC,IAAI,GAAGJ,MAAM,CAACE,OAAO,CAACC,aAAa,EAAE;MAC3C,IAAIC,IAAI,KAAK,QAAQ,EAAE;QACrBb,QAAQ,CAAC,mCAAmC,CAAC;QAC7CI,YAAY,GAAGK,MAAM;MACvB;IACF;EACF,CAAC,CAAC;AACJ,CAAC;AAED,MAAMK,mBAAmB,GAAG;EAC1BC,IAAI,EAAE,CAACC,KAAa,EAAEC,OAAe,EAAEC,MAAc,EAAEC,QAAgB,EAAEb,OAAc,KAAK;IAC1F,MAAMc,UAAU,GACd,qBAAqB,GAAGC,MAAM,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC;IACnEnB,QAAQ,CAACC,OAAO,CAAC;IACjB,IAAIT,SAAS,CAAC4B,SAAS,CAAC3B,mBAAmB,CAAC4B,SAAS,CAAC,EAAE;MACtD7B,SAAS,CAAC8B,kBAAkB,EAAE,CAACZ,IAAI,CAACC,KAAK,EAAEC,OAAO,CAAC;MACnDpB,SAAS,CAAC8B,kBAAkB,EAAE,CAACC,wBAAwB,CACrDR,UAAU,EACV,QAAoB;QAAA,IAAnB;UAAES;QAAW,CAAC;QACb1B,sBAAsB,GAAG0B,KAAK;MAChC,CAAC,CACF;MACD5B,QAAQ,CAACe,KAAK,GAAGA,KAAK;MACtBf,QAAQ,CAACgB,OAAO,GAAGA,OAAO;MAC1Bf,UAAU,CAACgB,MAAM,GAAGA,MAAM;MAC1BhB,UAAU,CAACiB,QAAQ,GAAGA,QAAQ;MAC9B,OAAOtB,SAAS,CAAC8B,kBAAkB,EAAE,CAACG,KAAK,CAACZ,MAAM,EAAEC,QAAQ,CAAC,CAACY,IAAI,CAAC,MAAM;QACvE/B,QAAQ,CAAC,0BAA0B,CAAC;QACpC,OAAO,IAAI;MACb,CAAC,CAAC;IACJ,CAAC,MAAM;MACLA,QAAQ,CAAC,+CAA+C,CAAC;MACzD,OAAOgC,OAAO,CAACC,OAAO,CAAC,KAAK,CAAC;IAC/B;EACF,CAAC;EACDC,QAAQ,CAACC,MAAc,EAAE;IACvB,IAAItC,SAAS,CAAC4B,SAAS,CAAC3B,mBAAmB,CAAC4B,SAAS,CAAC,EAAE;MACtD,OAAO7B,SAAS,CAAC8B,kBAAkB,EAAE,CAACO,QAAQ,CAACC,MAAM,CAAC,CAACJ,IAAI,CAAC,MAAM;QAChE/B,QAAQ,CAAC,8BAA8B,CAAC;QACxC,OAAO,IAAI;MACb,CAAC,CAAC;IACJ,CAAC,MAAM;MACLA,QAAQ,CAAC,+CAA+C,CAAC;MACzD,OAAOgC,OAAO,CAACC,OAAO,CAAC,KAAK,CAAC;IAC/B;EACF,CAAC;EACDG,uBAAuB,EAAE,MAAM;IAC7B,IAAIvC,SAAS,CAAC4B,SAAS,CAAC3B,mBAAmB,CAAC4B,SAAS,CAAC,EAAE;MACtD1B,QAAQ,CACN,mCAAmC,EACnCG,sBAAsB,EACtBJ,6BAA6B,CAACsC,YAAY,CAC3C;MACD,IAAIlC,sBAAsB,KAAKJ,6BAA6B,CAACsC,YAAY,EAAE;QACzExC,SAAS,CAAC8B,kBAAkB,EAAE,CAACW,MAAM,EAAE,CAACP,IAAI,CAAC,MAAM;UACjD/B,QAAQ,CAAC,gCAAgC,CAAC;UAC1CH,SAAS,CAAC8B,kBAAkB,EAAE,CAACG,KAAK,CAClC5B,UAAU,CAACgB,MAAM,EACjBhB,UAAU,CAACiB,QAAQ,CACpB,CAACY,IAAI,CAAC,MAAM;YACX/B,QAAQ,CAAC,mCAAmC,CAAC;UAC/C,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ;IACF,CAAC,MAAM;MACLA,QAAQ,CAAC,+CAA+C,CAAC;IAC3D;EACF,CAAC;EACDuC,MAAM,EAAE,MAAM;IACZ,IAAI1C,SAAS,CAAC4B,SAAS,CAAC3B,mBAAmB,CAAC4B,SAAS,CAAC,EAAE;MACtD7B,SAAS,CAAC8B,kBAAkB,EAAE,CAACW,MAAM,EAAE;MACvCzC,SAAS,CAAC8B,kBAAkB,EAAE,CAACY,MAAM,EAAE;IACzC;EACF,CAAC;EACDC,YAAY,EAAE,MAAM;IAClB,OAAOtC,UAAU;EACnB,CAAC;EACDuC,UAAU,EAAE,MAAM;IAChB,OAAOxC,QAAQ;EACjB,CAAC;EACDyC,eAAe,EAAE,MAAM;IACrB,OAAOtC,YAAY;EACrB;AACF,CAAC;AAED,eAAeU,mBAAmB"}
{"version":3,"names":["React","useEffect","StyleSheet","View","ZegoRequestCoHostButton","ZegoCancelRequestCoHostButton","ZegoEndCoHostButton","ZegoCoHostConnectState","ZegoToastType","ZegoTranslationText","ZegoUIKit","zloginfo","grantPermissions","ZegoCoHostControlButton","props","hostID","liveStatus","isPluginsInit","memberConnectState","idle","onConnectStateChanged","setIsToastVisable","setToastExtendedData","setIsDialogVisable","setDialogExtendedData","ZegoCoHostControlButtonType","request","cancel","end","coHostControlHandle","btnType","newConnectState","connecting","callbackID","String","Math","floor","random","getSignalingPlugin","onInvitationResponseTimeout","console","log","onInvitationAccepted","error","turnCameraOn","turnMicrophoneOn","connected","onInvitationRefused","type","text","hostRejectCoHostRequestToast","styles","btnContainer","bind","create"],"sources":["ZegoCoHostControlButton.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { StyleSheet, View } from \"react-native\"\nimport ZegoRequestCoHostButton from './ZegoRequestCoHostButton';\nimport ZegoCancelRequestCoHostButton from './ZegoCancelRequestCoHostButton';\nimport ZegoEndCoHostButton from './ZegoEndCoHostButton';\nimport { ZegoCoHostConnectState, ZegoToastType, ZegoTranslationText } from '../services/defines'\nimport ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport { zloginfo } from \"../utils/logger\";\nimport { grantPermissions } from '../utils';\n\nexport default function ZegoCoHostControlButton(props: any) {\n    const {\n        hostID,\n        liveStatus,\n        isPluginsInit,\n        memberConnectState = ZegoCoHostConnectState.idle,\n        onConnectStateChanged,\n        setIsToastVisable,\n        setToastExtendedData,\n        setIsDialogVisable,\n        setDialogExtendedData,\n    } = props;\n    const ZegoCoHostControlButtonType = {\n        request: 0,\n        cancel: 1,\n        end: 2,\n    };\n\n    const coHostControlHandle = (btnType: number) => {\n        let newConnectState = memberConnectState;\n        if (btnType === ZegoCoHostControlButtonType.request) {\n            newConnectState = ZegoCoHostConnectState.connecting;\n        } else if (btnType === ZegoCoHostControlButtonType.cancel) {\n            newConnectState = ZegoCoHostConnectState.idle;\n        } else if (btnType === ZegoCoHostControlButtonType.end) {\n            newConnectState = ZegoCoHostConnectState.idle;\n        }\n        onConnectStateChanged('', newConnectState);\n    };\n\n    useEffect(() => {\n        const callbackID = 'ZegoCoHostControlButton' + String(Math.floor(Math.random() * 10000));\n        if (isPluginsInit) {\n            // Plugins init success and register plugins callback\n            zloginfo('[ZegoCoHostControlButton]Plugins init success and register plugins callback');\n            ZegoUIKit.getSignalingPlugin().onInvitationResponseTimeout(callbackID, () => {\n                // The host did not process your cohost request, resulting in a timeout\n                console.log('#######onInvitationResponseTimeout, The host did not process your cohost request, resulting in a timeout');\n                onConnectStateChanged('', ZegoCoHostConnectState.idle, true);\n            });\n            ZegoUIKit.getSignalingPlugin().onInvitationAccepted(callbackID, async () => {\n                // The host accepted your cohost request\n                console.log('#######onInvitationAccepted, The host accepted your cohost request');\n                try {\n                    await grantPermissions();\n                } catch (error) {\n                }\n                ZegoUIKit.turnCameraOn('', true);\n                ZegoUIKit.turnMicrophoneOn('', true);\n                onConnectStateChanged('', ZegoCoHostConnectState.connected, true);\n            });\n            ZegoUIKit.getSignalingPlugin().onInvitationRefused(callbackID, () => {\n                // The host rejected your cohost request\n                console.log('#######onInvitationRefused, The host rejected your cohost request');\n                onConnectStateChanged('', ZegoCoHostConnectState.idle, true);\n                setIsToastVisable(true);\n                setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.hostRejectCoHostRequestToast });\n            });\n        }\n        return () => {\n            if (isPluginsInit) {\n                ZegoUIKit.getSignalingPlugin().onInvitationResponseTimeout(callbackID);\n                ZegoUIKit.getSignalingPlugin().onInvitationAccepted(callbackID);\n                ZegoUIKit.getSignalingPlugin().onInvitationRefused(callbackID);\n            }\n        };\n    }, [isPluginsInit]);\n\n    return (\n        <View style={styles.btnContainer}>\n            {\n                memberConnectState === ZegoCoHostConnectState.idle ? <ZegoRequestCoHostButton\n                    hostID={hostID}\n                    liveStatus={liveStatus}\n                    // @ts-ignore\n                    onRequestSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.request)}\n                    setIsToastVisable={setIsToastVisable}\n                    setToastExtendedData={setToastExtendedData}\n                    \n                /> :\n                memberConnectState === ZegoCoHostConnectState.connecting ? <ZegoCancelRequestCoHostButton\n                    hostID={hostID}\n                    // @ts-ignore\n                    onCancelSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.cancel)}\n                    setIsToastVisable={setIsToastVisable}\n                    setToastExtendedData={setToastExtendedData}\n                /> :\n                memberConnectState === ZegoCoHostConnectState.connected ? <ZegoEndCoHostButton\n                    // @ts-ignore\n                    onEndSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.end)}\n                    setIsDialogVisable={setIsDialogVisable}\n                    setDialogExtendedData={setDialogExtendedData}\n                /> :\n                null\n            }\n        </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n    btnContainer: {},\n});\n"],"mappings":"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"}
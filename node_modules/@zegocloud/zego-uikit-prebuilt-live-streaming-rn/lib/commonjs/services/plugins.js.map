{"version":3,"names":["_appInfo","_localUser","_pluginConnectionState","ZIMKitPlugin","_install","plugins","ZegoUIKit","installPlugins","forEach","plugin","ZIMKit","zloginfo","default","getModuleName","temp","ZegoPrebuiltPlugins","init","appID","appSign","userID","userName","callbackID","String","Math","floor","random","getPlugin","ZegoUIKitPluginType","signaling","getSignalingPlugin","onConnectionStateChanged","state","login","then","Promise","resolve","joinRoom","roomID","reconnectIfDisconnected","ZegoInvitationConnectionState","disconnected","logout","uninit","getLocalUser","getAppInfo","getZIMKitPlugin"],"sources":["plugins.ts"],"sourcesContent":["import ZegoUIKit, {\n  ZegoUIKitPluginType,\n  ZegoInvitationConnectionState,\n} from '@zegocloud/zego-uikit-rn';\nimport { zloginfo } from '../utils/logger';\n\nconst _appInfo = {} as any;\nconst _localUser = {} as any;\nlet _pluginConnectionState: number;\nlet ZIMKitPlugin: any = null;\nconst _install = (plugins: any[]) => {\n  ZegoUIKit.installPlugins(plugins);\n  plugins.forEach(plugin => {\n    if (plugin.ZIMKit) {\n      zloginfo('[Plugins] install ZIMKit success.');\n      ZIMKitPlugin = plugin;\n    } else if (plugin.default && typeof plugin.default.getModuleName === 'function') {\n      const temp = plugin.default.getModuleName();\n      if (temp === 'ZIMKit') {\n        zloginfo('[Plugins] install ZIMKit success.');\n        ZIMKitPlugin = plugin;\n      }\n    }\n  })\n};\n\nconst ZegoPrebuiltPlugins = {\n  init: (appID: number, appSign: string, userID: string, userName: string, plugins: any[]) => {\n    const callbackID =\n      'ZegoPrebuiltPlugins' + String(Math.floor(Math.random() * 10000));\n    _install(plugins);\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKit.getSignalingPlugin().init(appID, appSign);\n      ZegoUIKit.getSignalingPlugin().onConnectionStateChanged(\n        callbackID,\n        ({ state }: any) => {\n          _pluginConnectionState = state;\n        }\n      );\n      _appInfo.appID = appID;\n      _appInfo.appSign = appSign;\n      _localUser.userID = userID;\n      _localUser.userName = userName;\n      return ZegoUIKit.getSignalingPlugin().login(userID, userName).then(() => {\n        zloginfo('[Plugins] login success.');\n        return true;\n      });\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n      return Promise.resolve(false);\n    }\n  },\n  joinRoom(roomID: string) {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      return ZegoUIKit.getSignalingPlugin().joinRoom(roomID).then(() => {\n        zloginfo('[Plugins] join room success.');\n        return true;\n      });\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n      return Promise.resolve(false);\n    }\n  },\n  reconnectIfDisconnected: () => {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      zloginfo(\n        '[Plugins] reconnectIfDisconnected',\n        _pluginConnectionState,\n        ZegoInvitationConnectionState.disconnected\n      );\n      if (_pluginConnectionState === ZegoInvitationConnectionState.disconnected) {\n        ZegoUIKit.getSignalingPlugin().logout().then(() => {\n          zloginfo('[Plugins] auto logout success.');\n          ZegoUIKit.getSignalingPlugin().login(\n            _localUser.userID,\n            _localUser.userName\n          ).then(() => {\n            zloginfo('[Plugins] auto reconnect success.');\n          });\n        });\n      }\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n    }\n  },\n  uninit: () => {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKit.getSignalingPlugin().logout();\n      ZegoUIKit.getSignalingPlugin().uninit();\n    }\n  },\n  getLocalUser: () => {\n    return _localUser;\n  },\n  getAppInfo: () => {\n    return _appInfo;\n  },\n  getZIMKitPlugin: () => {\n    return ZIMKitPlugin;\n  }\n};\n\nexport default ZegoPrebuiltPlugins;\n"],"mappings":"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"}
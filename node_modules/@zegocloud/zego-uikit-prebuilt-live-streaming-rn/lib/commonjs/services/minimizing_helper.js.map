{"version":3,"names":["MinimizingHelper","constructor","getInstance","_instance","getIsMinimize","_isMinimize","setIsMinimizeSwitch","isMinimizeSwitch","_isMinimizeSwitch","getIsMinimizeSwitch","setInitParams","appID","appSign","userID","userName","roomID","config","_appInfo","_localUser","_roomID","Object","assign","_config","getInitAppInfo","getInitUser","getInitRoomID","getInitConfig","getInitPlugins","_plugins","minimizeWindow","callbackID","String","Math","floor","random","unRegisterAudioVideoListCallback","registerAudioVideoListCallback","notifyMinimize","startUpdateTimer","updateActiveUserIDByTimer","initUpdateTimer","clearInterval","_updateTimer","activeUserID","PrebuiltHelper","getRealTimeData","hostID","_activeUserID","ZegoUIKit","getLocalUserInfo","notifyActiveUserIDUpdate","notifyPrebuiltInit","keys","_onPrebuiltInitCallbackMap","forEach","_onActiveUserIDUpdateCallbackMap","_onWindowMinimizeCallbackMap","notifyMaximize","_onWindowMaximizeCallbackMap","notifyEntryNormal","_onEntryNormalCallbackMap","onPrebuiltInit","callback","onActiveUserIDUpdate","onWindowMinimized","onWindowMaximized","onEntryNormal"],"sources":["minimizing_helper.ts"],"sourcesContent":["import ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport PrebuiltHelper from \"./prebuilt_helper\";\n\nexport default class MinimizingHelper {\n    static _instance: MinimizingHelper;\n    _isMinimize = false;\n    _isMinimizeSwitch = false;\n    _activeUserID = '';\n    _onActiveUserIDUpdateCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onWindowMinimizeCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onWindowMaximizeCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onEntryNormalCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _updateTimer: null | NodeJS.Timer = null;\n    _appInfo: {\n        appID?: number;\n        appSign?: String;\n    } = {};\n    _localUser: {\n        userID?: string;\n        userName?: string;\n    } = {};\n    _roomID = '';\n    _config: any = {};\n    _plugins: any[] = [];\n    _onPrebuiltInitCallbackMap: { [index: string]: (data?: any) => void } = {};\n    constructor() { }\n    static getInstance() {\n        return this._instance || (this._instance = new MinimizingHelper());\n    }\n    getIsMinimize() {\n        return this._isMinimize;\n    }\n    setIsMinimizeSwitch(isMinimizeSwitch: boolean) {\n        this._isMinimizeSwitch = !!isMinimizeSwitch;\n    }\n    getIsMinimizeSwitch() {\n        return this._isMinimizeSwitch;\n    }\n    setInitParams(appID: number, appSign: string, userID: string, userName: string, roomID: string, config = {}) {\n        this._appInfo = { appID, appSign };\n        this._localUser = { userID, userName };\n        this._roomID = roomID;\n        Object.assign(this._config, config);\n    }\n    getInitAppInfo() {\n        return this._appInfo;\n    }\n    getInitUser() {\n        return this._localUser;\n    }\n    getInitRoomID() {\n        return this._roomID;\n    }\n    getInitConfig() {\n        return this._config;\n    }\n    getInitPlugins() {\n        return this._plugins;\n    }\n    minimizeWindow() {\n        const callbackID = 'MinimizingHelper' + String(Math.floor(Math.random() * 10000));\n        this.unRegisterAudioVideoListCallback(callbackID);\n        this.registerAudioVideoListCallback(callbackID);\n\n        this.notifyMinimize();\n        this.startUpdateTimer();\n    }\n    startUpdateTimer() {\n        this.updateActiveUserIDByTimer();\n\n        this.initUpdateTimer();\n    }\n    initUpdateTimer() {\n        clearInterval(this._updateTimer);\n        this._updateTimer = null;\n    }\n    updateActiveUserIDByTimer() {\n        const activeUserID = PrebuiltHelper.getInstance().getRealTimeData().hostID;\n        this._activeUserID = activeUserID|| ZegoUIKit.getLocalUserInfo().userID || '';\n        \n        // console.log('[MinimizingHelper]updateActiveUserIDByTimer', this._activeUserID);\n        this.notifyActiveUserIDUpdate(this._activeUserID);\n    }\n    registerAudioVideoListCallback(callbackID: string) {\n    }\n    unRegisterAudioVideoListCallback(callbackID: string) {\n    }\n    notifyPrebuiltInit() {\n        Object.keys(this._onPrebuiltInitCallbackMap).forEach((callbackID) => {\n            if (this._onPrebuiltInitCallbackMap[callbackID]) {\n                this._onPrebuiltInitCallbackMap[callbackID]();\n            }\n        });\n    }\n    notifyActiveUserIDUpdate(activeUserID: string) {\n        Object.keys(this._onActiveUserIDUpdateCallbackMap).forEach((callbackID) => {\n            if (this._onActiveUserIDUpdateCallbackMap[callbackID]) {\n                this._onActiveUserIDUpdateCallbackMap[callbackID](activeUserID);\n            }\n        })\n    }\n    notifyMinimize() {\n        this._isMinimize = true;\n\n        Object.keys(this._onWindowMinimizeCallbackMap).forEach((callbackID) => {\n            if (this._onWindowMinimizeCallbackMap[callbackID]) {\n                this._onWindowMinimizeCallbackMap[callbackID]();\n            }\n        })\n    }\n    notifyMaximize() {\n        this._isMinimize = false;\n\n        Object.keys(this._onWindowMaximizeCallbackMap).forEach((callbackID) => {\n            if (this._onWindowMaximizeCallbackMap[callbackID]) {\n                this._onWindowMaximizeCallbackMap[callbackID]();\n            }\n        })\n    }\n    notifyEntryNormal() {\n        this._isMinimize = false;\n\n        Object.keys(this._onEntryNormalCallbackMap).forEach((callbackID) => {\n            if (this._onEntryNormalCallbackMap[callbackID]) {\n                this._onEntryNormalCallbackMap[callbackID]();\n            }\n        })\n    }\n    onPrebuiltInit(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onPrebuiltInitCallbackMap[callbackID];\n        } else {\n            this._onPrebuiltInitCallbackMap[callbackID] = callback;\n        }\n    }\n    onActiveUserIDUpdate(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onActiveUserIDUpdateCallbackMap[callbackID];\n        } else {\n            this._onActiveUserIDUpdateCallbackMap[callbackID] = callback;\n        }\n    }\n    onWindowMinimized(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onWindowMinimizeCallbackMap[callbackID];\n        } else {\n            this._onWindowMinimizeCallbackMap[callbackID] = callback;\n        }\n    }\n    onWindowMaximized(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onWindowMaximizeCallbackMap[callbackID];\n        } else {\n            this._onWindowMaximizeCallbackMap[callbackID] = callback;\n        }\n    }\n    onEntryNormal(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onEntryNormalCallbackMap[callbackID];\n        } else {\n            this._onEntryNormalCallbackMap[callbackID] = callback;\n        }\n    }\n}"],"mappings":"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"}
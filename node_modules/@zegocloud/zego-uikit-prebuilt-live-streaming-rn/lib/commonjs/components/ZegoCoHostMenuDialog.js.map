{"version":3,"names":["ZegoCoHostMenuDialog","props","countdownMap","useRef","countdownTimerMap","visable","inviteeID","invitationType","ZegoInvitationType","inviteToCoHost","onCancel","onOk","setIsToastVisable","setToastExtendedData","resetTimer","inviteeCountdown","current","get","set","clearInterval","getCustomContainerStyle","StyleSheet","create","customContainer","display","willPressedHandle","result","console","log","type","ZegoToastType","error","text","ZegoTranslationText","repeatInviteCoHostFailedToast","setInterval","ZegoUIKit","getUser","inviteCoHostFailedToast","removeHandle","removeUserFromRoom","then","useEffect","Map","Array","from","keys","forEach","key","styles","container","inviteCoHostButton","replace","removeCoHostButton","divide","removeButton","removeText","removeUserMenuDialogButton","cancelButton","cancelText","cancelMenuDialogButton","width","zIndex","position","bottom","borderTopLeftRadius","borderTopRightRadius","backgroundColor","height","opacity","alignItems","justifyContent","fontSize","color"],"sources":["ZegoCoHostMenuDialog.tsx"],"sourcesContent":["import React, { useEffect, useRef }from \"react\";\nimport ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport { StyleSheet, View, Text, TouchableOpacity } from \"react-native\";\nimport { ZegoSendInvitationButton } from '@zegocloud/zego-uikit-rn';\nimport { ZegoTranslationText, ZegoInvitationType, ZegoToastType } from \"../services/defines\";\n\n\nexport default function ZegoCoHostMenuDialog(props: any) {\n    const countdownMap = useRef();\n    const countdownTimerMap = useRef();\n    const {\n        visable,\n        inviteeID,\n        invitationType = ZegoInvitationType.inviteToCoHost,\n        onCancel,\n        onOk,\n        setIsToastVisable,\n        setToastExtendedData,\n        resetTimer,\n    } = props;\n\n    if (visable) {\n        const inviteeCountdown = (countdownMap.current as any).get(inviteeID);\n        if (!inviteeCountdown) {\n            (countdownMap.current as any).set(inviteeID, 60);\n        }\n    }\n    if (resetTimer) {\n        // Reset invitation timer\n        clearInterval((countdownTimerMap.current as any).get(inviteeID));\n        (countdownMap.current as any).set(inviteeID, 60);\n        (countdownTimerMap.current as any).set(inviteeID, null);\n    }\n\n    const getCustomContainerStyle = (visable: boolean) => StyleSheet.create({\n        customContainer: {\n            display: visable ? 'flex' : 'none',\n        },\n    });\n    // Verify whether invitations can be sent\n    const willPressedHandle = () => {\n        let result = true;\n        if (invitationType === ZegoInvitationType.inviteToCoHost) {\n            // Check whether the timer is running out\n            console.log('#########Timer: Check whether the timer is running out', countdownMap.current, countdownTimerMap.current);\n\n            if ((countdownTimerMap.current as any).get(inviteeID)) {\n                // The timer did not complete and the request was not allowed to occur\n                console.log('#########Timer: The timer did not complete and the request was not allowed to occur', countdownMap.current, countdownTimerMap.current);\n                setIsToastVisable(true);\n                setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.repeatInviteCoHostFailedToast });\n                onCancel();\n                result = false;\n            } else {\n                // Restart timer\n                clearInterval((countdownTimerMap.current as any).get(inviteeID));\n                (countdownTimerMap.current as any).set(inviteeID ,setInterval(() => {\n                    console.log('#########Timer: countdown', countdownMap.current, countdownTimerMap.current);\n                    if ((countdownMap.current as any).get(inviteeID) === 0) {\n                        clearInterval((countdownTimerMap.current as any).get(inviteeID));\n                        (countdownTimerMap.current as any).set(inviteeID, null);\n                        (countdownMap.current as any).set(inviteeID, 60);\n                    } else {\n                        (countdownMap.current as any).set(inviteeID, (countdownMap.current as any).get(inviteeID) - 1);\n                    }\n                }, 1000));\n                if (!ZegoUIKit.getUser(inviteeID)) {\n                    result = false;\n                    setIsToastVisable(true);\n                    setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.inviteCoHostFailedToast });\n                    onCancel();\n                }\n            }\n        }\n        return result;\n    }\n    const removeHandle = () => {\n        ZegoUIKit.removeUserFromRoom([inviteeID]).then(() => {\n            console.log(`remove ${inviteeID} from room successfully`);\n            // The handling here is the same as the cancel\n            onCancel();\n        });\n        \n    }\n\n    useEffect(() => {\n        // First render initializes and clears timer\n        console.log('#########Timer: First render initializes and clears timer', countdownMap.current, countdownTimerMap.current);\n        (countdownMap.current as any) = new Map();\n        (countdownTimerMap.current as any) = new Map();\n        return () => {\n            // Initializes and clears timer when component is destroyed\n            console.log('#########Timer: Initializes and clears timer when component is destroyed', countdownMap.current, countdownTimerMap.current);\n            Array.from((countdownTimerMap.current as any).keys()).forEach((key) => {\n                clearInterval((countdownTimerMap.current as any).get(key));\n                (countdownTimerMap.current as any).set(key, null);\n            });\n        };\n    }, []);\n\n    return <View style={[styles.container, getCustomContainerStyle(visable).customContainer]}>\n        <ZegoSendInvitationButton\n            backgroundColor={'transparent'}\n            width='100%'\n            height={50}\n            fontSize={14}\n            color='#fff'\n            text={\n                invitationType === ZegoInvitationType.inviteToCoHost ?\n                    ZegoTranslationText.inviteCoHostButton.replace('%0', inviteeID) :\n                    ZegoTranslationText.removeCoHostButton\n            }\n            invitees={[inviteeID]}\n            type={invitationType}\n            onWillPressed={willPressedHandle}\n            onPressed={onOk}\n        ></ZegoSendInvitationButton>\n        <View style={styles.divide}></View>\n        {/* remove xxx from the room */}\n        <TouchableOpacity style={styles.removeButton} onPress={removeHandle}>\n            <Text style={styles.removeText}>{ZegoTranslationText.removeUserMenuDialogButton.replace('%0', inviteeID)}</Text>\n        </TouchableOpacity>\n        <View style={styles.divide}></View>\n        <TouchableOpacity style={styles.cancelButton} onPress={onCancel}>\n            <Text style={styles.cancelText}>{ZegoTranslationText.cancelMenuDialogButton}</Text>\n        </TouchableOpacity>\n    </View>\n}\n \nconst styles = StyleSheet.create({\n    container: {\n        width: '100%',\n        zIndex: 12,\n        position: 'absolute',\n        bottom: 0,\n        borderTopLeftRadius: 16,\n        borderTopRightRadius: 16,\n        backgroundColor: 'rgba(17,16,20,0.9)',\n    },\n    divide: {\n        width: '100%',\n        height: 1,\n        backgroundColor: '#FFFFFF',\n        opacity: 0.1,\n    },\n    cancelButton: {\n        width: '100%',\n        height: 50,\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    cancelText: {\n        fontSize: 14,\n        color: '#fff',\n    },\n    removeButton: {\n        height: 50,\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    removeText: {\n        fontSize: 14,\n        color: '#fff',\n    },\n});"],"mappings":"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"}
{"version":3,"names":["ZegoCoHostControlButton","props","hostID","liveStatus","isPluginsInit","memberConnectState","ZegoCoHostConnectState","idle","onConnectStateChanged","setIsToastVisable","setToastExtendedData","setIsDialogVisable","setDialogExtendedData","ZegoCoHostControlButtonType","request","cancel","end","coHostControlHandle","btnType","newConnectState","connecting","useEffect","callbackID","String","Math","floor","random","zloginfo","ZegoUIKit","getSignalingPlugin","onInvitationResponseTimeout","console","log","onInvitationAccepted","grantPermissions","error","turnCameraOn","turnMicrophoneOn","connected","onInvitationRefused","type","ZegoToastType","text","ZegoTranslationText","hostRejectCoHostRequestToast","styles","btnContainer","bind","StyleSheet","create"],"sources":["ZegoCoHostControlButton.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { StyleSheet, View } from \"react-native\"\nimport ZegoRequestCoHostButton from './ZegoRequestCoHostButton';\nimport ZegoCancelRequestCoHostButton from './ZegoCancelRequestCoHostButton';\nimport ZegoEndCoHostButton from './ZegoEndCoHostButton';\nimport { ZegoCoHostConnectState, ZegoToastType, ZegoTranslationText } from '../services/defines'\nimport ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport { zloginfo } from \"../utils/logger\";\nimport { grantPermissions } from '../utils';\n\nexport default function ZegoCoHostControlButton(props: any) {\n    const {\n        hostID,\n        liveStatus,\n        isPluginsInit,\n        memberConnectState = ZegoCoHostConnectState.idle,\n        onConnectStateChanged,\n        setIsToastVisable,\n        setToastExtendedData,\n        setIsDialogVisable,\n        setDialogExtendedData,\n    } = props;\n    const ZegoCoHostControlButtonType = {\n        request: 0,\n        cancel: 1,\n        end: 2,\n    };\n\n    const coHostControlHandle = (btnType: number) => {\n        let newConnectState = memberConnectState;\n        if (btnType === ZegoCoHostControlButtonType.request) {\n            newConnectState = ZegoCoHostConnectState.connecting;\n        } else if (btnType === ZegoCoHostControlButtonType.cancel) {\n            newConnectState = ZegoCoHostConnectState.idle;\n        } else if (btnType === ZegoCoHostControlButtonType.end) {\n            newConnectState = ZegoCoHostConnectState.idle;\n        }\n        onConnectStateChanged('', newConnectState);\n    };\n\n    useEffect(() => {\n        const callbackID = 'ZegoCoHostControlButton' + String(Math.floor(Math.random() * 10000));\n        if (isPluginsInit) {\n            // Plugins init success and register plugins callback\n            zloginfo('[ZegoCoHostControlButton]Plugins init success and register plugins callback');\n            ZegoUIKit.getSignalingPlugin().onInvitationResponseTimeout(callbackID, () => {\n                // The host did not process your cohost request, resulting in a timeout\n                console.log('#######onInvitationResponseTimeout, The host did not process your cohost request, resulting in a timeout');\n                onConnectStateChanged('', ZegoCoHostConnectState.idle, true);\n            });\n            ZegoUIKit.getSignalingPlugin().onInvitationAccepted(callbackID, async () => {\n                // The host accepted your cohost request\n                console.log('#######onInvitationAccepted, The host accepted your cohost request');\n                try {\n                    await grantPermissions();\n                } catch (error) {\n                }\n                ZegoUIKit.turnCameraOn('', true);\n                ZegoUIKit.turnMicrophoneOn('', true);\n                onConnectStateChanged('', ZegoCoHostConnectState.connected, true);\n            });\n            ZegoUIKit.getSignalingPlugin().onInvitationRefused(callbackID, () => {\n                // The host rejected your cohost request\n                console.log('#######onInvitationRefused, The host rejected your cohost request');\n                onConnectStateChanged('', ZegoCoHostConnectState.idle, true);\n                setIsToastVisable(true);\n                setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.hostRejectCoHostRequestToast });\n            });\n        }\n        return () => {\n            if (isPluginsInit) {\n                ZegoUIKit.getSignalingPlugin().onInvitationResponseTimeout(callbackID);\n                ZegoUIKit.getSignalingPlugin().onInvitationAccepted(callbackID);\n                ZegoUIKit.getSignalingPlugin().onInvitationRefused(callbackID);\n            }\n        };\n    }, [isPluginsInit]);\n\n    return (\n        <View style={styles.btnContainer}>\n            {\n                memberConnectState === ZegoCoHostConnectState.idle ? <ZegoRequestCoHostButton\n                    hostID={hostID}\n                    liveStatus={liveStatus}\n                    // @ts-ignore\n                    onRequestSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.request)}\n                    setIsToastVisable={setIsToastVisable}\n                    setToastExtendedData={setToastExtendedData}\n                    \n                /> :\n                memberConnectState === ZegoCoHostConnectState.connecting ? <ZegoCancelRequestCoHostButton\n                    hostID={hostID}\n                    // @ts-ignore\n                    onCancelSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.cancel)}\n                    setIsToastVisable={setIsToastVisable}\n                    setToastExtendedData={setToastExtendedData}\n                /> :\n                memberConnectState === ZegoCoHostConnectState.connected ? <ZegoEndCoHostButton\n                    // @ts-ignore\n                    onEndSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.end)}\n                    setIsDialogVisable={setIsDialogVisable}\n                    setDialogExtendedData={setDialogExtendedData}\n                /> :\n                null\n            }\n        </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n    btnContainer: {},\n});\n"],"mappings":"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"}